(base) baodinh@asus ~$ git clone https://github.com/BAoD1nH/Difix3D.git --recursive
Cloning into 'Difix3D'...
remote: Enumerating objects: 54, done.
remote: Counting objects: 100% (17/17), done.
remote: Compressing objects: 100% (16/16), done.
remote: Total 54 (delta 5), reused 1 (delta 1), pack-reused 37 (from 1)
Receiving objects: 100% (54/54), 5.52 MiB | 7.45 MiB/s, done.
Resolving deltas: 100% (8/8), done.
(base) baodinh@asus ~$ cd Difix3D
(base) baodinh@asus ~/Difix3D$ conda create -n difix3d_env python=3.10 -y
2 channel Terms of Service accepted
Retrieving notices: done
Channels:
 - pytorch
 - conda-forge
 - defaults
Platform: linux-64
Collecting package metadata (repodata.json): done
Solving environment: done


==> WARNING: A newer version of conda exists. <==
    current version: 25.5.1
    latest version: 25.11.1

Please update conda by running

    $ conda update -n base -c defaults conda



## Package Plan ##

  environment location: /home/baodinh/miniconda3/envs/difix3d_env

  added / updated specs:
    - python=3.10


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    libffi-3.5.2               |       h3435931_0          57 KB  conda-forge
    openssl-3.6.1              |       h35e630c_1         3.0 MB  conda-forge
    packaging-26.0             |     pyhcf101f3_0          70 KB  conda-forge
    python-3.10.19             |h3c07f61_3_cpython        24.2 MB  conda-forge
    setuptools-80.10.1         |     pyh332efcf_0         662 KB  conda-forge
    tk-8.6.13                  |noxft_h366c992_103         3.1 MB  conda-forge
    wheel-0.46.3               |     pyhd8ed1ab_0          31 KB  conda-forge
    ------------------------------------------------------------
                                           Total:        31.2 MB

The following NEW packages will be INSTALLED:

  _libgcc_mutex      conda-forge/linux-64::_libgcc_mutex-0.1-conda_forge 
  _openmp_mutex      conda-forge/linux-64::_openmp_mutex-4.5-2_gnu 
  bzip2              conda-forge/linux-64::bzip2-1.0.8-hda65f42_8 
  ca-certificates    conda-forge/noarch::ca-certificates-2026.1.4-hbd8a1cb_0 
  icu                conda-forge/linux-64::icu-78.2-h33c6efd_0 
  ld_impl_linux-64   conda-forge/linux-64::ld_impl_linux-64-2.45-default_hbd61a6d_105 
  libexpat           conda-forge/linux-64::libexpat-2.7.3-hecca717_0 
  libffi             conda-forge/linux-64::libffi-3.5.2-h3435931_0 
  libgcc             conda-forge/linux-64::libgcc-15.2.0-he0feb66_16 
  libgcc-ng          conda-forge/linux-64::libgcc-ng-15.2.0-h69a702a_16 
  libgomp            conda-forge/linux-64::libgomp-15.2.0-he0feb66_16 
  liblzma            conda-forge/linux-64::liblzma-5.8.2-hb03c661_0 
  libnsl             conda-forge/linux-64::libnsl-2.0.1-hb9d3cd8_1 
  libsqlite          conda-forge/linux-64::libsqlite-3.51.2-hf4e2dac_0 
  libstdcxx          conda-forge/linux-64::libstdcxx-15.2.0-h934c35e_16 
  libuuid            conda-forge/linux-64::libuuid-2.41.3-h5347b49_0 
  libxcrypt          conda-forge/linux-64::libxcrypt-4.4.36-hd590300_1 
  libzlib            conda-forge/linux-64::libzlib-1.3.1-hb9d3cd8_2 
  ncurses            conda-forge/linux-64::ncurses-6.5-h2d0b736_3 
  openssl            conda-forge/linux-64::openssl-3.6.1-h35e630c_1 
  packaging          conda-forge/noarch::packaging-26.0-pyhcf101f3_0 
  pip                conda-forge/noarch::pip-25.3-pyh8b19718_0 
  python             conda-forge/linux-64::python-3.10.19-h3c07f61_3_cpython 
  readline           conda-forge/linux-64::readline-8.3-h853b02a_0 
  setuptools         conda-forge/noarch::setuptools-80.10.1-pyh332efcf_0 
  tk                 conda-forge/linux-64::tk-8.6.13-noxft_h366c992_103 
  tzdata             conda-forge/noarch::tzdata-2025c-hc9c84f9_1 
  wheel              conda-forge/noarch::wheel-0.46.3-pyhd8ed1ab_0 
  zstd               conda-forge/linux-64::zstd-1.5.7-hb78ec9c_6 



Downloading and Extracting Packages:
                                                                              
Preparing transaction: done                                                   
Verifying transaction: done                                                   
Executing transaction: done                                                   
#                                                                             
# To activate this environment, use                                           
#                                                                             
#     $ conda activate difix3d_env
#
# To deactivate an active environment, use
#
#     $ conda deactivate

(base) baodinh@asus ~/Difix3D$ conda activate difix3d_env
(difix3d_env) baodinh@asus ~/Difix3D$ # Cài đặt PyTorch với hỗ trợ CUDA 12.1 (Khuyến nghị)
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
Looking in indexes: https://download.pytorch.org/whl/cu121
Collecting torch
  Downloading https://download.pytorch.org/whl/cu121/torch-2.5.1%2Bcu121-cp310-cp310-linux_x86_64.whl (780.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 780.4/780.4 MB 13.1 MB/s  0:00:57
Collecting torchvision
  Downloading https://download.pytorch.org/whl/cu121/torchvision-0.20.1%2Bcu121-cp310-cp310-linux_x86_64.whl (7.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 7.3/7.3 MB 15.5 MB/s  0:00:00
Collecting torchaudio
  Downloading https://download.pytorch.org/whl/cu121/torchaudio-2.5.1%2Bcu121-cp310-cp310-linux_x86_64.whl (3.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.4/3.4 MB 14.3 MB/s  0:00:00
Collecting filelock (from torch)
  Using cached filelock-3.20.0-py3-none-any.whl.metadata (2.1 kB)
Collecting typing-extensions>=4.8.0 (from torch)
  Using cached https://download.pytorch.org/whl/typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Collecting networkx (from torch)
  Using cached networkx-3.4.2-py3-none-any.whl.metadata (6.3 kB)
Collecting jinja2 (from torch)
  Using cached https://download.pytorch.org/whl/jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)
Collecting fsspec (from torch)
  Using cached fsspec-2025.12.0-py3-none-any.whl.metadata (10 kB)
Collecting nvidia-cuda-nvrtc-cu12==12.1.105 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (23.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 23.7/23.7 MB 14.3 MB/s  0:00:01
Collecting nvidia-cuda-runtime-cu12==12.1.105 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (823 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 823.6/823.6 kB 6.9 MB/s  0:00:00
Collecting nvidia-cuda-cupti-cu12==12.1.105 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (14.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 14.1/14.1 MB 14.7 MB/s  0:00:00
Collecting nvidia-cudnn-cu12==9.1.0.70 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl (664.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 664.8/664.8 MB 14.3 MB/s  0:00:45
Collecting nvidia-cublas-cu12==12.1.3.1 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl (410.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 410.6/410.6 MB 14.7 MB/s  0:00:27
Collecting nvidia-cufft-cu12==11.0.2.54 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl (121.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 121.6/121.6 MB 15.2 MB/s  0:00:08
Collecting nvidia-curand-cu12==10.3.2.106 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl (56.5 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 56.5/56.5 MB 13.7 MB/s  0:00:04
Collecting nvidia-cusolver-cu12==11.4.5.107 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl (124.2 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 124.2/124.2 MB 13.7 MB/s  0:00:09
Collecting nvidia-cusparse-cu12==12.1.0.106 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl (196.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 196.0/196.0 MB 13.7 MB/s  0:00:14
Collecting nvidia-nccl-cu12==2.21.5 (from torch)
  Downloading https://download.pytorch.org/whl/nvidia_nccl_cu12-2.21.5-py3-none-manylinux2014_x86_64.whl (188.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 188.7/188.7 MB 14.5 MB/s  0:00:13
Collecting nvidia-nvtx-cu12==12.1.105 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (99 kB)
Collecting triton==3.1.0 (from torch)
  Downloading https://download.pytorch.org/whl/triton-3.1.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (209.5 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 209.5/209.5 MB 14.7 MB/s  0:00:14
Collecting sympy==1.13.1 (from torch)
  Downloading sympy-1.13.1-py3-none-any.whl.metadata (12 kB)
Collecting nvidia-nvjitlink-cu12 (from nvidia-cusolver-cu12==11.4.5.107->torch)
  Downloading https://download.pytorch.org/whl/nvidia_nvjitlink_cu12-12.9.86-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl.metadata (1.7 kB)
Collecting mpmath<1.4,>=1.1.0 (from sympy==1.13.1->torch)
  Using cached mpmath-1.3.0-py3-none-any.whl.metadata (8.6 kB)
Collecting numpy (from torchvision)
  Using cached numpy-2.2.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (62 kB)
Collecting pillow!=8.3.*,>=5.3.0 (from torchvision)
  Using cached pillow-12.0.0-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (8.8 kB)
Collecting MarkupSafe>=2.0 (from jinja2->torch)
  Using cached https://download.pytorch.org/whl/MarkupSafe-2.1.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (25 kB)
Downloading sympy-1.13.1-py3-none-any.whl (6.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.2/6.2 MB 11.5 MB/s  0:00:00
Using cached mpmath-1.3.0-py3-none-any.whl (536 kB)
Using cached pillow-12.0.0-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (7.0 MB)
Using cached https://download.pytorch.org/whl/typing_extensions-4.15.0-py3-none-any.whl (44 kB)
Using cached filelock-3.20.0-py3-none-any.whl (16 kB)
Using cached fsspec-2025.12.0-py3-none-any.whl (201 kB)
Using cached https://download.pytorch.org/whl/jinja2-3.1.6-py3-none-any.whl (134 kB)
Using cached networkx-3.4.2-py3-none-any.whl (1.7 MB)
Using cached numpy-2.2.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.8 MB)
Downloading https://download.pytorch.org/whl/nvidia_nvjitlink_cu12-12.9.86-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl (39.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 39.7/39.7 MB 12.1 MB/s  0:00:03
Installing collected packages: mpmath, typing-extensions, sympy, pillow, nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, numpy, networkx, MarkupSafe, fsspec, filelock, triton, nvidia-cusparse-cu12, nvidia-cudnn-cu12, jinja2, nvidia-cusolver-cu12, torch, torchvision, torchaudio
Successfully installed MarkupSafe-2.1.5 filelock-3.20.0 fsspec-2025.12.0 jinja2-3.1.6 mpmath-1.3.0 networkx-3.4.2 numpy-2.2.6 nvidia-cublas-cu12-12.1.3.1 nvidia-cuda-cupti-cu12-12.1.105 nvidia-cuda-nvrtc-cu12-12.1.105 nvidia-cuda-runtime-cu12-12.1.105 nvidia-cudnn-cu12-9.1.0.70 nvidia-cufft-cu12-11.0.2.54 nvidia-curand-cu12-10.3.2.106 nvidia-cusolver-cu12-11.4.5.107 nvidia-cusparse-cu12-12.1.0.106 nvidia-nccl-cu12-2.21.5 nvidia-nvjitlink-cu12-12.9.86 nvidia-nvtx-cu12-12.1.105 pillow-12.0.0 sympy-1.13.1 torch-2.5.1+cu121 torchaudio-2.5.1+cu121 torchvision-0.20.1+cu121 triton-3.1.0 typing-extensions-4.15.0
(difix3d_env) baodinh@asus ~/Difix3D$ pip install -r requirements.txt
Requirement already satisfied: torch in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements.txt (line 1)) (2.5.1+cu121)
Requirement already satisfied: torchvision in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements.txt (line 2)) (0.20.1+cu121)
Collecting torchmetrics (from -r requirements.txt (line 3))
  Using cached torchmetrics-1.8.2-py3-none-any.whl.metadata (22 kB)
Collecting wandb (from -r requirements.txt (line 4))
  Downloading wandb-0.24.0-py3-none-manylinux_2_28_x86_64.whl.metadata (12 kB)
Collecting einops (from -r requirements.txt (line 6))
  Downloading einops-0.8.2-py3-none-any.whl.metadata (13 kB)
Collecting lpips (from -r requirements.txt (line 7))
  Downloading lpips-0.1.4-py3-none-any.whl.metadata (10 kB)
Collecting xformers (from -r requirements.txt (line 8))
  Downloading xformers-0.0.34-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (1.2 kB)
Collecting peft==0.9.0 (from -r requirements.txt (line 9))
  Downloading peft-0.9.0-py3-none-any.whl.metadata (13 kB)
Collecting diffusers==0.25.1 (from -r requirements.txt (line 10))
  Downloading diffusers-0.25.1-py3-none-any.whl.metadata (19 kB)
Collecting huggingface-hub==0.25.1 (from -r requirements.txt (line 11))
  Downloading huggingface_hub-0.25.1-py3-none-any.whl.metadata (13 kB)
Collecting transformers==4.38.0 (from -r requirements.txt (line 12))
  Downloading transformers-4.38.0-py3-none-any.whl.metadata (131 kB)
Collecting imageio[ffmpeg] (from -r requirements.txt (line 5))
  Using cached imageio-2.37.2-py3-none-any.whl.metadata (9.7 kB)
Requirement already satisfied: numpy>=1.17 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from peft==0.9.0->-r requirements.txt (line 9)) (2.2.6)
Requirement already satisfied: packaging>=20.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from peft==0.9.0->-r requirements.txt (line 9)) (26.0)
Collecting psutil (from peft==0.9.0->-r requirements.txt (line 9))
  Using cached psutil-7.2.1-cp36-abi3-manylinux2010_x86_64.manylinux_2_12_x86_64.manylinux_2_28_x86_64.whl.metadata (22 kB)
Collecting pyyaml (from peft==0.9.0->-r requirements.txt (line 9))
  Using cached pyyaml-6.0.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (2.4 kB)
Collecting tqdm (from peft==0.9.0->-r requirements.txt (line 9))
  Using cached tqdm-4.67.1-py3-none-any.whl.metadata (57 kB)
Collecting accelerate>=0.21.0 (from peft==0.9.0->-r requirements.txt (line 9))
  Downloading accelerate-1.12.0-py3-none-any.whl.metadata (19 kB)
Collecting safetensors (from peft==0.9.0->-r requirements.txt (line 9))
  Downloading safetensors-0.7.0-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
Collecting importlib-metadata (from diffusers==0.25.1->-r requirements.txt (line 10))
  Using cached importlib_metadata-8.7.1-py3-none-any.whl.metadata (4.7 kB)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from diffusers==0.25.1->-r requirements.txt (line 10)) (3.20.0)
Collecting regex!=2019.12.17 (from diffusers==0.25.1->-r requirements.txt (line 10))
  Downloading regex-2026.1.15-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (40 kB)
Collecting requests (from diffusers==0.25.1->-r requirements.txt (line 10))
  Using cached requests-2.32.5-py3-none-any.whl.metadata (4.9 kB)
Requirement already satisfied: Pillow in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from diffusers==0.25.1->-r requirements.txt (line 10)) (12.0.0)
Requirement already satisfied: fsspec>=2023.5.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from huggingface-hub==0.25.1->-r requirements.txt (line 11)) (2025.12.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from huggingface-hub==0.25.1->-r requirements.txt (line 11)) (4.15.0)
Collecting tokenizers<0.19,>=0.14 (from transformers==4.38.0->-r requirements.txt (line 12))
  Downloading tokenizers-0.15.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.7 kB)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (3.1.6)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (2.21.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (12.1.105)
Requirement already satisfied: triton==3.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (3.1.0)
Requirement already satisfied: sympy==1.13.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->-r requirements.txt (line 1)) (1.13.1)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch->-r requirements.txt (line 1)) (12.9.86)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy==1.13.1->torch->-r requirements.txt (line 1)) (1.3.0)
Collecting lightning-utilities>=0.8.0 (from torchmetrics->-r requirements.txt (line 3))
  Using cached lightning_utilities-0.15.2-py3-none-any.whl.metadata (5.7 kB)
Collecting click>=8.0.1 (from wandb->-r requirements.txt (line 4))
  Using cached click-8.3.1-py3-none-any.whl.metadata (2.6 kB)
Collecting gitpython!=3.1.29,>=1.0.0 (from wandb->-r requirements.txt (line 4))
  Downloading gitpython-3.1.46-py3-none-any.whl.metadata (13 kB)
Collecting platformdirs (from wandb->-r requirements.txt (line 4))
  Downloading platformdirs-4.5.1-py3-none-any.whl.metadata (12 kB)
Collecting protobuf!=4.21.0,!=5.28.0,<7,>=3.19.0 (from wandb->-r requirements.txt (line 4))
  Downloading protobuf-6.33.4-cp39-abi3-manylinux2014_x86_64.whl.metadata (593 bytes)
Collecting pydantic<3 (from wandb->-r requirements.txt (line 4))
  Downloading pydantic-2.12.5-py3-none-any.whl.metadata (90 kB)
Collecting sentry-sdk>=2.0.0 (from wandb->-r requirements.txt (line 4))
  Downloading sentry_sdk-2.50.0-py2.py3-none-any.whl.metadata (10 kB)
Collecting annotated-types>=0.6.0 (from pydantic<3->wandb->-r requirements.txt (line 4))
  Using cached annotated_types-0.7.0-py3-none-any.whl.metadata (15 kB)
Collecting pydantic-core==2.41.5 (from pydantic<3->wandb->-r requirements.txt (line 4))
  Downloading pydantic_core-2.41.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (7.3 kB)
Collecting typing-inspection>=0.4.2 (from pydantic<3->wandb->-r requirements.txt (line 4))
  Downloading typing_inspection-0.4.2-py3-none-any.whl.metadata (2.6 kB)
Collecting charset_normalizer<4,>=2 (from requests->diffusers==0.25.1->-r requirements.txt (line 10))
  Using cached charset_normalizer-3.4.4-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (37 kB)
Collecting idna<4,>=2.5 (from requests->diffusers==0.25.1->-r requirements.txt (line 10))
  Using cached idna-3.11-py3-none-any.whl.metadata (8.4 kB)
Collecting urllib3<3,>=1.21.1 (from requests->diffusers==0.25.1->-r requirements.txt (line 10))
  Using cached urllib3-2.6.3-py3-none-any.whl.metadata (6.9 kB)
Collecting certifi>=2017.4.17 (from requests->diffusers==0.25.1->-r requirements.txt (line 10))
  Using cached certifi-2026.1.4-py3-none-any.whl.metadata (2.5 kB)
Collecting imageio-ffmpeg (from imageio[ffmpeg]->-r requirements.txt (line 5))
  Using cached imageio_ffmpeg-0.6.0-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)
Collecting scipy>=1.0.1 (from lpips->-r requirements.txt (line 7))
  Using cached scipy-1.15.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (61 kB)
INFO: pip is looking at multiple versions of xformers to determine which version is compatible with other requirements. This could take a while.
Collecting xformers (from -r requirements.txt (line 8))
  Downloading xformers-0.0.33.post2-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (1.2 kB)
  Downloading xformers-0.0.33.post1-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (1.2 kB)
  Downloading xformers-0.0.33-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (1.2 kB)
  Downloading xformers-0.0.32.post2-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (1.1 kB)
  Downloading xformers-0.0.32.post1-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (1.1 kB)
  Downloading xformers-0.0.31.post1-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (1.1 kB)
  Downloading xformers-0.0.31-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (1.0 kB)
INFO: pip is still looking at multiple versions of xformers to determine which version is compatible with other requirements. This could take a while.
  Downloading xformers-0.0.30-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (1.0 kB)
  Downloading xformers-0.0.29.post3-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (1.0 kB)
  Downloading xformers-0.0.29.post2-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (1.0 kB)
  Downloading xformers-0.0.29.post1-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (1.0 kB)
Collecting gitdb<5,>=4.0.1 (from gitpython!=3.1.29,>=1.0.0->wandb->-r requirements.txt (line 4))
  Downloading gitdb-4.0.12-py3-none-any.whl.metadata (1.2 kB)
Collecting smmap<6,>=3.0.1 (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb->-r requirements.txt (line 4))
  Downloading smmap-5.0.2-py3-none-any.whl.metadata (4.3 kB)
Requirement already satisfied: setuptools in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from lightning-utilities>=0.8.0->torchmetrics->-r requirements.txt (line 3)) (80.10.1)
Collecting zipp>=3.20 (from importlib-metadata->diffusers==0.25.1->-r requirements.txt (line 10))
  Using cached zipp-3.23.0-py3-none-any.whl.metadata (3.6 kB)
Requirement already satisfied: MarkupSafe>=2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jinja2->torch->-r requirements.txt (line 1)) (2.1.5)
Downloading peft-0.9.0-py3-none-any.whl (190 kB)
Downloading diffusers-0.25.1-py3-none-any.whl (1.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.8/1.8 MB 6.7 MB/s  0:00:00
Downloading huggingface_hub-0.25.1-py3-none-any.whl (436 kB)
Downloading transformers-4.38.0-py3-none-any.whl (8.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.5/8.5 MB 9.3 MB/s  0:00:00
Downloading tokenizers-0.15.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.6/3.6 MB 5.6 MB/s  0:00:00
Using cached torchmetrics-1.8.2-py3-none-any.whl (983 kB)
Downloading wandb-0.24.0-py3-none-manylinux_2_28_x86_64.whl (22.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 22.8/22.8 MB 13.3 MB/s  0:00:01
Downloading protobuf-6.33.4-cp39-abi3-manylinux2014_x86_64.whl (323 kB)
Downloading pydantic-2.12.5-py3-none-any.whl (463 kB)
Downloading pydantic_core-2.41.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.1/2.1 MB 9.9 MB/s  0:00:00
Using cached requests-2.32.5-py3-none-any.whl (64 kB)
Using cached charset_normalizer-3.4.4-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (153 kB)
Using cached idna-3.11-py3-none-any.whl (71 kB)
Using cached urllib3-2.6.3-py3-none-any.whl (131 kB)
Using cached imageio-2.37.2-py3-none-any.whl (317 kB)
Downloading einops-0.8.2-py3-none-any.whl (65 kB)
Downloading lpips-0.1.4-py3-none-any.whl (53 kB)
Downloading xformers-0.0.29.post1-cp310-cp310-manylinux_2_28_x86_64.whl (15.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 15.3/15.3 MB 11.8 MB/s  0:00:01
Downloading accelerate-1.12.0-py3-none-any.whl (380 kB)
Using cached annotated_types-0.7.0-py3-none-any.whl (13 kB)
Using cached certifi-2026.1.4-py3-none-any.whl (152 kB)
Using cached click-8.3.1-py3-none-any.whl (108 kB)
Downloading gitpython-3.1.46-py3-none-any.whl (208 kB)
Downloading gitdb-4.0.12-py3-none-any.whl (62 kB)
Downloading smmap-5.0.2-py3-none-any.whl (24 kB)
Using cached lightning_utilities-0.15.2-py3-none-any.whl (29 kB)
Using cached pyyaml-6.0.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (770 kB)
Downloading regex-2026.1.15-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (791 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 791.8/791.8 kB 8.2 MB/s  0:00:00
Downloading safetensors-0.7.0-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (507 kB)
Using cached scipy-1.15.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (37.7 MB)
Downloading sentry_sdk-2.50.0-py2.py3-none-any.whl (424 kB)
Using cached tqdm-4.67.1-py3-none-any.whl (78 kB)
Downloading typing_inspection-0.4.2-py3-none-any.whl (14 kB)
Using cached imageio_ffmpeg-0.6.0-py3-none-manylinux2014_x86_64.whl (29.5 MB)
Using cached importlib_metadata-8.7.1-py3-none-any.whl (27 kB)
Using cached zipp-3.23.0-py3-none-any.whl (10 kB)
Downloading platformdirs-4.5.1-py3-none-any.whl (18 kB)
Using cached psutil-7.2.1-cp36-abi3-manylinux2010_x86_64.manylinux_2_12_x86_64.manylinux_2_28_x86_64.whl (154 kB)
Installing collected packages: zipp, urllib3, typing-inspection, tqdm, smmap, scipy, safetensors, regex, pyyaml, pydantic-core, psutil, protobuf, platformdirs, lightning-utilities, imageio-ffmpeg, imageio, idna, einops, click, charset_normalizer, certifi, annotated-types, sentry-sdk, requests, pydantic, importlib-metadata, gitdb, huggingface-hub, gitpython, xformers, wandb, torchmetrics, tokenizers, diffusers, accelerate, transformers, lpips, peft
Successfully installed accelerate-1.12.0 annotated-types-0.7.0 certifi-2026.1.4 charset_normalizer-3.4.4 click-8.3.1 diffusers-0.25.1 einops-0.8.2 gitdb-4.0.12 gitpython-3.1.46 huggingface-hub-0.25.1 idna-3.11 imageio-2.37.2 imageio-ffmpeg-0.6.0 importlib-metadata-8.7.1 lightning-utilities-0.15.2 lpips-0.1.4 peft-0.9.0 platformdirs-4.5.1 protobuf-6.33.4 psutil-7.2.1 pydantic-2.12.5 pydantic-core-2.41.5 pyyaml-6.0.3 regex-2026.1.15 requests-2.32.5 safetensors-0.7.0 scipy-1.15.3 sentry-sdk-2.50.0 smmap-5.0.2 tokenizers-0.15.2 torchmetrics-1.8.2 tqdm-4.67.1 transformers-4.38.0 typing-inspection-0.4.2 urllib3-2.6.3 wandb-0.24.0 xformers-0.0.29.post1 zipp-3.23.0
(difix3d_env) baodinh@asus ~/Difix3D$ python -c "import torch; print(f'CUDA available: {torch.cuda.is_available()}'); print(f'GPU Name: {torch.cuda.get_device_name(0)}')"
CUDA available: True
GPU Name: NVIDIA GeForce RTX 4060 Laptop GPU
(difix3d_env) baodinh@asus ~/Difix3D$ nano test_setup.py
(difix3d_env) baodinh@asus ~/Difix3D$ python test_setup.py
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/test_setup.py", line 1, in <module>
    from pipeline_difix import DifixPipeline
ModuleNotFoundError: No module named 'pipeline_difix'
(difix3d_env) baodinh@asus ~/Difix3D$ # Đang ở (difix3d_env) baodinh@asus ~/Difix3D$

# 1. Thêm folder src vào PYTHONPATH
export PYTHONPATH=$PYTHONPATH:$(pwd)/src

# 2. Chạy lại file test
python test_setup.py
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
CUDA available: True
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
model_index.json: 100%|██████████████████████| 586/586 [00:00<00:00, 2.96MB/s]
tokenizer_config.json: 100%|█████████████████| 885/885 [00:00<00:00, 5.91MB/s]
config.json: 100%|███████████████████████████| 603/603 [00:00<00:00, 4.20MB/s]
config.json: 1.85kB [00:00, 1.27MB/s]
scheduler_config.json: 100%|█████████████████| 700/700 [00:00<00:00, 4.57MB/s]
vocab.json: 1.06MB [00:00, 8.78MB/s]           | 2/13 [00:00<00:02,  3.99it/s]
merges.txt: 525kB [00:00, 4.45MB/s]
special_tokens_map.json: 100%|███████████████| 574/574 [00:00<00:00, 2.50MB/s]
config.json: 100%|████████████████████████████| 698/698 [00:00<00:00, 553kB/s]
autoencoder_kl.py: 24.5kB [00:00, 27.9MB/s]       | 0.00/1.36G [00:00<?, ?B/s]
diffusion_pytorch_model.safetensors: 100%|█| 339M/339M [01:18<00:00, 4.34MB/s]
model.safetensors:  29%|█████▎            | 398M/1.36G [01:17<06:05, 2.64MB/sError while downloading from https://cas-bridge.xethub.hf.co/xet-bridge-us/683f2b151f1ca6d52eaedc19/17d6bad94502b94cd3940323e88f0ca39ae6f5a928a3146bff9dc57b65853962?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=cas%2F20260128%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260128T035223Z&X-Amz-Expires=3600&X-Amz-Signature=97fccad6a1bbfaabbd71ce4fbb43832801b6405415be5579945fbaa90445cf4c&X-Amz-SignedHeaders=host&X-Xet-Cas-Uid=public&response-content-disposition=inline%3B+filename*%3DUTF-8%27%27model.safetensors%3B+filename%3D%22model.safetensors%22%3B&x-id=GetObject&Expires=1769575943&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc2OTU3NTk0M319LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2FzLWJyaWRnZS54ZXRodWIuaGYuY28veGV0LWJyaWRnZS11cy82ODNmMmIxNTFmMWNhNmQ1MmVhZWRjMTkvMTdkNmJhZDk0NTAyYjk0Y2QzOTQwMzIzZTg4ZjBjYTM5YWU2ZjVhOTI4YTMxNDZiZmY5ZGM1N2I2NTg1Mzk2MioifV19&Signature=UGvpLP%7EI%7E7YUNDNdg57-iciBdmh8uq91eD%7EOW0uXLkee5h9oYd%7Enc3wT2ECtn8SxqRvipaR52XJ3md59kdGYnxaVtI9T8tT4vPYRsIGjxoZOENOAQHTzn0jvXLDBVzdGt%7EICqSuq82ahd0PvpUnF8ou5kmscds6%7EgC8OyN5MP1zknBEgfdsaWZkn1YX65tjgMDDSxTbCf3DJuOZvT9SygCJv14qSLPoduHjNzsFuK4wRtgF1Nk3-gtJQO3-wdsB6OEURaWtZRV-6hegGPLhFu936A9PvHHwUgtlQAoR51tPd0IdYDPf5LBcqr-wax8SEu5hpuwCou8sAIFcrexOiuA__&Key-Pair-Id=K2L8F4GPSG1IFC: HTTPSConnectionPool(host='cas-bridge.xethub.hf.co', port=443): Read timed out.
Trying to resume download...
Error while downloading from https://cas-bridge.xethub.hf.co/xet-bridge-us/683f2b151f1ca6d52eaedc19/55841cec3e3c7fc4d89d649db6c58410bd6d64f808e23398580400e55f78d298?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=cas%2F20260128%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260128T035223Z&X-Amz-Expires=3600&X-Amz-Signature=bb9ad7c4ec3b2f4d11427c0b6307c2962287324ec8c1377e580b046fec2bbf6f&X-Amz-SignedHeaders=host&X-Xet-Cas-Uid=public&response-content-disposition=inline%3B+filename*%3DUTF-8%27%27diffusion_pytorch_model.safetensors%3B+filename%3D%22diffusion_pytorch_model.safetensors%22%3B&x-id=GetObject&Expires=1769575943&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc2OTU3NTk0M319LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2FzLWJyaWRnZS54ZXRodWIuaGYuY28veGV0LWJyaWRnZS11cy82ODNmMmIxNTFmMWNhNmQ1MmVhZWRjMTkvNTU4NDFjZWMzZTNjN2ZjNGQ4OWQ2NDlkYjZjNTg0MTBiZDZkNjRmODA4ZTIzMzk4NTgwNDAwZTU1Zjc4ZDI5OCoifV19&Signature=q4b748%7Exai72EnsLhoIXY7ctpY0HZpspMh%7EDNcugbXOy6GKlJwJQROPrLvqLONs09L3DM-lCgn5vj9MWk6tAWVQUNHeV%7Em9ZDLbCw7AwDhzYMJOM9J4aOSJ78y0CCahUntUuxsgO6IIru9pWi9QdcYMwtWLGygi1UTtjrzUW8Ls1w7tvLvuf%7EzSxyeanlmr5UfbApF31jyyI6b4KJoP0S-9L5eHzJ01wp5IlzP%7ElX4Eqa5iHllGsRzfJCq1kla0b07gyRHCTNIIYyhYU-2DhreqmykjAvXZ9ir5FDKKz-u1P1vkL9eQSEq6HLtkTgTbb3pXHQYKt9lISwH8tTrG13g__&Key-Pair-Id=K2L8F4GPSG1IFC: HTTPSConnectionPool(host='cas-bridge.xethub.hf.co', port=443): Read timed out.
Trying to resume download...
model.safetensors: 100%|█████████████████| 1.36G/1.36G [03:58<00:00, 4.04MB/s]
model.safetensors:  29%|█████▎            | 398M/1.36G [05:29<13:16, 1.21MB/s]
diffusion_pytorch_model.safetensors: 100%|█| 3.46G/3.46G [09:45<00:00, 5.54MB/
diffusion_pytorch_model.safetensors:   6%| | 220M/3.46G [11:16<2:46:01, 326kB/
Fetching 13 files: 100%|██████████████████████| 13/13 [11:17<00:00, 52.12s/it]
Keyword arguments {'trust_remote_code': True} are not expected by DifixPipeline and will be ignored.l.safetensors: 100%|█| 3.46G/3.46G [09:45<00:00, 12.5MB/
Loading pipeline components...: 100%|███████████| 5/5 [00:00<00:00, 17.89it/s]
You have disabled the safety checker for <class 'pipeline_difix.DifixPipeline'> by passing `safety_checker=None`. Ensure that you abide to the conditions of the Stable Diffusion license and do not expose unfiltered results in services or applications open to the public. Both the diffusers team and Hugging Face strongly recommend to keep the safety filter enabled in all public facing circumstances, disabling it only for use-cases that involve analyzing network behavior or auditing its results. For more information, please have a look at https://github.com/huggingface/diffusers/pull/254 .
100%|███████████████████████████████████████████| 1/1 [00:00<00:00,  2.62it/s]
Có lỗi xảy ra: CUDA out of memory. Tried to allocate 504.00 MiB. GPU 0 has a total capacity of 7.62 GiB of which 371.19 MiB is free. Including non-PyTorch memory, this process has 7.24 GiB memory in use. Of the allocated memory 6.80 GiB is allocated by PyTorch, and 323.17 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
(difix3d_env) baodinh@asus ~/Difix3D$ python src/test_setup.py
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
CUDA available: True
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(

Vẫn gặp lỗi: The deprecation tuple ('no variant default', '0.24.0', "You are trying to load the model files of the `variant=fp16`, but no such modeling files are available.The default model files: {'unet/diffusion_pytorch_model.safetensors', 'vae/diffusion_pytorch_model.safetensors', 'text_encoder/model.safetensors'} will be loaded instead. Make sure to not load from `variant=fp16`if such variant modeling files are not available. Doing so will lead to an error in v0.24.0 as defaulting to non-variantmodeling files is deprecated.") should be removed since diffusers' version 0.25.1 is >= 0.24.0
(difix3d_env) baodinh@asus ~/Difix3D$ python test_setup.py
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
CUDA available: True
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(

Vẫn gặp lỗi: The deprecation tuple ('no variant default', '0.24.0', "You are trying to load the model files of the `variant=fp16`, but no such modeling files are available.The default model files: {'text_encoder/model.safetensors', 'vae/diffusion_pytorch_model.safetensors', 'unet/diffusion_pytorch_model.safetensors'} will be loaded instead. Make sure to not load from `variant=fp16`if such variant modeling files are not available. Doing so will lead to an error in v0.24.0 as defaulting to non-variantmodeling files is deprecated.") should be removed since diffusers' version 0.25.1 is >= 0.24.0
(difix3d_env) baodinh@asus ~/Difix3D$ python test_setup.py
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
CUDA available: True
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Keyword arguments {'trust_remote_code': True} are not expected by DifixPipeline and will be ignored.
Loading pipeline components...: 100%|███████████| 5/5 [00:00<00:00,  8.65it/s]
You have disabled the safety checker for <class 'pipeline_difix.DifixPipeline'> by passing `safety_checker=None`. Ensure that you abide to the conditions of the Stable Diffusion license and do not expose unfiltered results in services or applications open to the public. Both the diffusers team and Hugging Face strongly recommend to keep the safety filter enabled in all public facing circumstances, disabling it only for use-cases that involve analyzing network behavior or auditing its results. For more information, please have a look at https://github.com/huggingface/diffusers/pull/254 .
Load model thành công, bắt đầu xử lý ảnh...
100%|███████████████████████████████████████████| 1/1 [00:00<00:00,  1.91it/s]
CHẠY THÀNH CÔNG! Ảnh kết quả đã lưu tại example_output.png
(difix3d_env) baodinh@asus ~/Difix3D$ # Cài đặt gsplat (phiên bản binary pre-built để đỡ phải compile lâu)
pip install gsplat
Collecting gsplat
  Downloading gsplat-1.5.3-py3-none-any.whl.metadata (1.1 kB)
Collecting ninja (from gsplat)
  Using cached ninja-1.13.0-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (5.1 kB)
Requirement already satisfied: numpy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat) (2.2.6)
Collecting jaxtyping (from gsplat)
  Downloading jaxtyping-0.3.6-py3-none-any.whl.metadata (7.3 kB)
Collecting rich>=12 (from gsplat)
  Downloading rich-14.3.1-py3-none-any.whl.metadata (18 kB)
Requirement already satisfied: torch in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat) (2.5.1+cu121)
Collecting markdown-it-py>=2.2.0 (from rich>=12->gsplat)
  Using cached markdown_it_py-4.0.0-py3-none-any.whl.metadata (7.3 kB)
Collecting pygments<3.0.0,>=2.13.0 (from rich>=12->gsplat)
  Using cached pygments-2.19.2-py3-none-any.whl.metadata (2.5 kB)
Collecting mdurl~=0.1 (from markdown-it-py>=2.2.0->rich>=12->gsplat)
  Using cached mdurl-0.1.2-py3-none-any.whl.metadata (1.6 kB)
Collecting wadler-lindig>=0.1.3 (from jaxtyping->gsplat)
  Using cached wadler_lindig-0.1.7-py3-none-any.whl.metadata (17 kB)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (3.20.0)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (4.15.0)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (3.1.6)
Requirement already satisfied: fsspec in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (2025.12.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (2.21.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (12.1.105)
Requirement already satisfied: triton==3.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (3.1.0)
Requirement already satisfied: sympy==1.13.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat) (1.13.1)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch->gsplat) (12.9.86)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy==1.13.1->torch->gsplat) (1.3.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jinja2->torch->gsplat) (2.1.5)
Downloading gsplat-1.5.3-py3-none-any.whl (6.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.5/6.5 MB 2.8 MB/s  0:00:02
Downloading rich-14.3.1-py3-none-any.whl (309 kB)
Using cached pygments-2.19.2-py3-none-any.whl (1.2 MB)
Using cached markdown_it_py-4.0.0-py3-none-any.whl (87 kB)
Using cached mdurl-0.1.2-py3-none-any.whl (10.0 kB)
Downloading jaxtyping-0.3.6-py3-none-any.whl (56 kB)
Using cached wadler_lindig-0.1.7-py3-none-any.whl (20 kB)
Using cached ninja-1.13.0-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (180 kB)
Installing collected packages: wadler-lindig, pygments, ninja, mdurl, markdown-it-py, jaxtyping, rich, gsplat
Successfully installed gsplat-1.5.3 jaxtyping-0.3.6 markdown-it-py-4.0.0 mdurl-0.1.2 ninja-1.13.0 pygments-2.19.2 rich-14.3.1 wadler-lindig-0.1.7
(difix3d_env) baodinh@asus ~/Difix3D$ mkdir -p data/garden
(difix3d_env) baodinh@asus ~/Difix3D$ # Đang ở thư mục gốc Difix3D
# 1. Tạo thư mục colmap bên trong garden
mkdir -p data/garden/colmap

# 2. Di chuyển thư mục sparse vào trong colmap
mv data/garden/sparse data/garden/colmap/

# Kiểm tra lại: Đường dẫn đúng phải là data/garden/colmap/sparse/0
(difix3d_env) baodinh@asus ~/Difix3D$ # Tải file simple_trainer.py từ repo gốc của gsplat về thư mục examples/gsplat của bạn
wget https://raw.githubusercontent.com/nerfstudio-project/gsplat/main/examples/simple_trainer.py -O examples/gsplat/simple_trainer.py
--2026-01-28 11:19:28--  https://raw.githubusercontent.com/nerfstudio-project/gsplat/main/examples/simple_trainer.py
\Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 2606:50c0:8003::154, 2606:50c0:8001::154, 2606:50c0:8002::154, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|2606:50c0:8003::154|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 58680 (57K) [text/plain]
Saving to: ‘examples/gsplat/simple_trainer.py’

examples/gsplat/sim 100%[=================>]  57.30K   160KB/s    in 0.4s    

2026-01-28 11:19:29 (160 KB/s) - ‘examples/gsplat/simple_trainer.py’ saved [58680/58680]

(difix3d_env) baodinh@asus ~/Difix3D$ \# Tạo thư mục lưu kết quả bước 1
mkdir -p outputs/garden_base

# Chạy train (Lưu ý: --data_factor 4 để giảm độ phân giải ảnh xuống 4 lần -> Tiết kiệm VRAM)
python examples/gsplat/simple_trainer.py default \
    --data_dir data/garden \
    --result_dir outputs/garden_base \
    --data_factor 4 \
    --iterations 2000 \
    --save_every 2000 \
    --disable_viewer  # Tắt viewer để đỡ tốn VRAM
#: command not found
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer.py", line 15, in <module>
    import tyro
ModuleNotFoundError: No module named 'tyro'
(difix3d_env) baodinh@asus ~/Difix3D$ pip install tyro tqdm
Collecting tyro
  Downloading tyro-1.0.5-py3-none-any.whl.metadata (12 kB)
Requirement already satisfied: tqdm in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (4.67.1)
Collecting docstring-parser>=0.15 (from tyro)
  Using cached docstring_parser-0.17.0-py3-none-any.whl.metadata (3.5 kB)
Collecting typeguard>=4.0.0 (from tyro)
  Using cached typeguard-4.4.4-py3-none-any.whl.metadata (3.3 kB)
Requirement already satisfied: typing-extensions>=4.13.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tyro) (4.15.0)
Downloading tyro-1.0.5-py3-none-any.whl (181 kB)
Using cached docstring_parser-0.17.0-py3-none-any.whl (36 kB)
Using cached typeguard-4.4.4-py3-none-any.whl (34 kB)
Installing collected packages: typeguard, docstring-parser, tyro
Successfully installed docstring-parser-0.17.0 typeguard-4.4.4 tyro-1.0.5
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer.py default     --data_dir data/garden     --result_dir outputs/garden_base     --data_factor 4     --iterations 2000     --save_every 2000     --disable_viewer  # Tắt viewer để đỡ tốn VRAM
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer.py", line 16, in <module>
    import viser
ModuleNotFoundError: No module named 'viser'
(difix3d_env) baodinh@asus ~/Difix3D$ pip install viser
Collecting viser
  Downloading viser-1.0.21-py3-none-any.whl.metadata (5.2 kB)
Requirement already satisfied: imageio<3.0.0,>=2.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser) (2.37.2)
Collecting msgspec<1.0.0,>=0.18.6 (from viser)
  Using cached msgspec-0.20.0-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (5.5 kB)
Collecting nodeenv<2.0.0,>=1.9.1 (from viser)
  Using cached nodeenv-1.10.0-py2.py3-none-any.whl.metadata (24 kB)
Requirement already satisfied: numpy<3.0.0,>=1.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser) (2.2.6)
Requirement already satisfied: requests<3.0.0,>=2.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser) (2.32.5)
Requirement already satisfied: rich<15.0.0,>=13.3.3 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser) (14.3.1)
Requirement already satisfied: tqdm<5.0.0,>=4.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser) (4.67.1)
Collecting trimesh<5.0.0,>=3.21.7 (from viser)
  Downloading trimesh-4.11.1-py3-none-any.whl.metadata (13 kB)
Requirement already satisfied: typing-extensions>=4.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser) (4.15.0)
Collecting websockets<16.0.0,>=13.1 (from viser)
  Using cached websockets-15.0.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.8 kB)
Collecting yourdfpy<1.0.0,>=0.0.53 (from viser)
  Downloading yourdfpy-0.0.60-py3-none-any.whl.metadata (9.0 kB)
Collecting zstandard<1.0.0,>=0.20.0 (from viser)
  Downloading zstandard-0.25.0-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (3.3 kB)
Requirement already satisfied: pillow>=8.3.2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from imageio<3.0.0,>=2.0.0->viser) (12.0.0)
Requirement already satisfied: charset_normalizer<4,>=2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser) (2.6.3)
Requirement already satisfied: certifi>=2017.4.17 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser) (2026.1.4)
Requirement already satisfied: markdown-it-py>=2.2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from rich<15.0.0,>=13.3.3->viser) (4.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from rich<15.0.0,>=13.3.3->viser) (2.19.2)
Collecting lxml (from yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached lxml-6.0.2-cp310-cp310-manylinux_2_26_x86_64.manylinux_2_28_x86_64.whl.metadata (3.6 kB)
Collecting six (from yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached six-1.17.0-py2.py3-none-any.whl.metadata (1.7 kB)
Requirement already satisfied: mdurl~=0.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from markdown-it-py>=2.2.0->rich<15.0.0,>=13.3.3->viser) (0.1.2)
Collecting colorlog (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached colorlog-6.10.1-py3-none-any.whl.metadata (11 kB)
Collecting manifold3d>=2.3.0 (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached manifold3d-3.3.2-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (19 kB)
Collecting jsonschema (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Downloading jsonschema-4.26.0-py3-none-any.whl.metadata (7.6 kB)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser) (3.4.2)
Collecting svg.path (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached svg_path-7.0-py2.py3-none-any.whl.metadata (14 kB)
Collecting pycollada (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Downloading pycollada-0.9.3-py3-none-any.whl.metadata (1.7 kB)
Collecting shapely (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached shapely-2.1.2-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (6.8 kB)
Collecting xxhash (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached xxhash-3.6.0-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (13 kB)
Collecting rtree (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached rtree-1.4.1-py3-none-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl.metadata (2.1 kB)
Collecting httpx (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached httpx-0.28.1-py3-none-any.whl.metadata (7.1 kB)
Requirement already satisfied: scipy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser) (1.15.3)
Collecting embreex (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached embreex-2.17.7.post7-cp310-cp310-manylinux2010_x86_64.manylinux_2_12_x86_64.manylinux_2_28_x86_64.whl.metadata (3.0 kB)
Collecting vhacdx (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached vhacdx-0.0.10-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (1.1 kB)
Collecting mapbox_earcut>=1.0.2 (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached mapbox_earcut-2.0.0-cp310-cp310-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl.metadata (2.5 kB)
Collecting anyio (from httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached anyio-4.12.1-py3-none-any.whl.metadata (4.3 kB)
Collecting httpcore==1.* (from httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached httpcore-1.0.9-py3-none-any.whl.metadata (21 kB)
Collecting h11>=0.16 (from httpcore==1.*->httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached h11-0.16.0-py3-none-any.whl.metadata (8.3 kB)
Collecting exceptiongroup>=1.0.2 (from anyio->httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached exceptiongroup-1.3.1-py3-none-any.whl.metadata (6.7 kB)
Collecting attrs>=22.2.0 (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached attrs-25.4.0-py3-none-any.whl.metadata (10 kB)
Collecting jsonschema-specifications>=2023.03.6 (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached jsonschema_specifications-2025.9.1-py3-none-any.whl.metadata (2.9 kB)
Collecting referencing>=0.28.4 (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached referencing-0.37.0-py3-none-any.whl.metadata (2.8 kB)
Collecting rpds-py>=0.25.0 (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached rpds_py-0.30.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
Collecting python-dateutil (from pycollada->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser)
  Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl.metadata (8.4 kB)
Downloading viser-1.0.21-py3-none-any.whl (4.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.9/4.9 MB 379.4 kB/s  0:00:21
Using cached msgspec-0.20.0-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (222 kB)
Using cached nodeenv-1.10.0-py2.py3-none-any.whl (23 kB)
Downloading trimesh-4.11.1-py3-none-any.whl (740 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 740.4/740.4 kB 2.2 MB/s  0:00:00
Using cached websockets-15.0.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (181 kB)
Downloading yourdfpy-0.0.60-py3-none-any.whl (22 kB)
Downloading zstandard-0.25.0-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (5.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5.6/5.6 MB 2.6 MB/s  0:00:02
Using cached manifold3d-3.3.2-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (1.2 MB)
Using cached mapbox_earcut-2.0.0-cp310-cp310-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl (59 kB)
Using cached colorlog-6.10.1-py3-none-any.whl (11 kB)
Using cached embreex-2.17.7.post7-cp310-cp310-manylinux2010_x86_64.manylinux_2_12_x86_64.manylinux_2_28_x86_64.whl (17.2 MB)
Using cached httpx-0.28.1-py3-none-any.whl (73 kB)
Using cached httpcore-1.0.9-py3-none-any.whl (78 kB)
Using cached h11-0.16.0-py3-none-any.whl (37 kB)
Using cached anyio-4.12.1-py3-none-any.whl (113 kB)
Using cached exceptiongroup-1.3.1-py3-none-any.whl (16 kB)
Downloading jsonschema-4.26.0-py3-none-any.whl (90 kB)
Using cached attrs-25.4.0-py3-none-any.whl (67 kB)
Using cached jsonschema_specifications-2025.9.1-py3-none-any.whl (18 kB)
Using cached referencing-0.37.0-py3-none-any.whl (26 kB)
Using cached rpds_py-0.30.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (390 kB)
Using cached lxml-6.0.2-cp310-cp310-manylinux_2_26_x86_64.manylinux_2_28_x86_64.whl (5.3 MB)
Downloading pycollada-0.9.3-py3-none-any.whl (129 kB)
Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)
Using cached six-1.17.0-py2.py3-none-any.whl (11 kB)
Using cached rtree-1.4.1-py3-none-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl (507 kB)
Using cached shapely-2.1.2-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (3.1 MB)
Using cached svg_path-7.0-py2.py3-none-any.whl (18 kB)
Using cached vhacdx-0.0.10-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (250 kB)
Using cached xxhash-3.6.0-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (193 kB)
Installing collected packages: zstandard, xxhash, websockets, vhacdx, trimesh, svg.path, six, shapely, rtree, rpds-py, nodeenv, msgspec, mapbox_earcut, manifold3d, lxml, h11, exceptiongroup, embreex, colorlog, attrs, referencing, python-dateutil, httpcore, anyio, pycollada, jsonschema-specifications, httpx, jsonschema, yourdfpy, viser
Successfully installed anyio-4.12.1 attrs-25.4.0 colorlog-6.10.1 embreex-2.17.7.post7 exceptiongroup-1.3.1 h11-0.16.0 httpcore-1.0.9 httpx-0.28.1 jsonschema-4.26.0 jsonschema-specifications-2025.9.1 lxml-6.0.2 manifold3d-3.3.2 mapbox_earcut-2.0.0 msgspec-0.20.0 nodeenv-1.10.0 pycollada-0.9.3 python-dateutil-2.9.0.post0 referencing-0.37.0 rpds-py-0.30.0 rtree-1.4.1 shapely-2.1.2 six-1.17.0 svg.path-7.0 trimesh-4.11.1 vhacdx-0.0.10 viser-1.0.21 websockets-15.0.1 xxhash-3.6.0 yourdfpy-0.0.60 zstandard-0.25.0
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer.py default     --data_dir data/garden     --result_dir outputs/garden_base     --data_factor 4     --iterations 2000     --save_every 2000     --disable_viewer  # Tắt viewer để đỡ tốn VRAM
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer.py", line 18, in <module>
    from gsplat.color_correct import color_correct_affine, color_correct_quadratic
ModuleNotFoundError: No module named 'gsplat.color_correct'
(difix3d_env) baodinh@asus ~/Difix3D$ mkdir -p outputs/garden_base/ckpts
(difix3d_env) baodinh@asus ~/Difix3D$ # 1. Cấp quyền cho Python tìm thấy module src (để tránh lỗi ModuleNotFound)
export PYTHONPATH=$PYTHONPATH:$(pwd)/src

# 2. Chạy lệnh Train Difix3D
python examples/gsplat/simple_trainer_difix3d.py default \
    --data_dir data/garden \
    --data_factor 4 \
    --result_dir outputs/difix3d_result \
    --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt \
    --iterations 32000 \
    --save_every 500 \
    --test_every 1000 \
    --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 10, in <module>
    import nerfview
ModuleNotFoundError: No module named 'nerfview'
(difix3d_env) baodinh@asus ~/Difix3D$ pip install nerfview
Collecting nerfview
  Downloading nerfview-0.1.3-py3-none-any.whl.metadata (6.3 kB)
Requirement already satisfied: viser>=0.2.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from nerfview) (1.0.21)
Requirement already satisfied: imageio<3.0.0,>=2.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (2.37.2)
Requirement already satisfied: msgspec<1.0.0,>=0.18.6 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (0.20.0)
Requirement already satisfied: nodeenv<2.0.0,>=1.9.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (1.10.0)
Requirement already satisfied: numpy<3.0.0,>=1.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (2.2.6)
Requirement already satisfied: requests<3.0.0,>=2.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (2.32.5)
Requirement already satisfied: rich<15.0.0,>=13.3.3 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (14.3.1)
Requirement already satisfied: tqdm<5.0.0,>=4.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (4.67.1)
Requirement already satisfied: trimesh<5.0.0,>=3.21.7 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (4.11.1)
Requirement already satisfied: typing-extensions>=4.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (4.15.0)
Requirement already satisfied: websockets<16.0.0,>=13.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (15.0.1)
Requirement already satisfied: yourdfpy<1.0.0,>=0.0.53 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (0.0.60)
Requirement already satisfied: zstandard<1.0.0,>=0.20.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser>=0.2.1->nerfview) (0.25.0)
Requirement already satisfied: pillow>=8.3.2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from imageio<3.0.0,>=2.0.0->viser>=0.2.1->nerfview) (12.0.0)
Requirement already satisfied: charset_normalizer<4,>=2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser>=0.2.1->nerfview) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser>=0.2.1->nerfview) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser>=0.2.1->nerfview) (2.6.3)
Requirement already satisfied: certifi>=2017.4.17 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser>=0.2.1->nerfview) (2026.1.4)
Requirement already satisfied: markdown-it-py>=2.2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from rich<15.0.0,>=13.3.3->viser>=0.2.1->nerfview) (4.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from rich<15.0.0,>=13.3.3->viser>=0.2.1->nerfview) (2.19.2)
Requirement already satisfied: lxml in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (6.0.2)
Requirement already satisfied: six in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (1.17.0)
Requirement already satisfied: mdurl~=0.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from markdown-it-py>=2.2.0->rich<15.0.0,>=13.3.3->viser>=0.2.1->nerfview) (0.1.2)
Requirement already satisfied: colorlog in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (6.10.1)
Requirement already satisfied: manifold3d>=2.3.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (3.3.2)
Requirement already satisfied: jsonschema in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (4.26.0)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (3.4.2)
Requirement already satisfied: svg.path in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (7.0)
Requirement already satisfied: pycollada in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (0.9.3)
Requirement already satisfied: shapely in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (2.1.2)
Requirement already satisfied: xxhash in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (3.6.0)
Requirement already satisfied: rtree in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (1.4.1)
Requirement already satisfied: httpx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (0.28.1)
Requirement already satisfied: scipy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (1.15.3)
Requirement already satisfied: embreex in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (2.17.7.post7)
Requirement already satisfied: vhacdx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (0.0.10)
Requirement already satisfied: mapbox_earcut>=1.0.2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (2.0.0)
Requirement already satisfied: anyio in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (4.12.1)
Requirement already satisfied: httpcore==1.* in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (1.0.9)
Requirement already satisfied: h11>=0.16 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from httpcore==1.*->httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (0.16.0)
Requirement already satisfied: exceptiongroup>=1.0.2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from anyio->httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (1.3.1)
Requirement already satisfied: attrs>=22.2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (25.4.0)
Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (2025.9.1)
Requirement already satisfied: referencing>=0.28.4 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (0.37.0)
Requirement already satisfied: rpds-py>=0.25.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (0.30.0)
Requirement already satisfied: python-dateutil in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from pycollada->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser>=0.2.1->nerfview) (2.9.0.post0)
Downloading nerfview-0.1.3-py3-none-any.whl (19 kB)
Installing collected packages: nerfview
Successfully installed nerfview-0.1.3
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default     --data_dir data/garden     --data_factor 4     --result_dir outputs/difix3d_result     --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt     --iterations 32000     --save_every 500     --test_every 1000     --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 10, in <module>
    import nerfview
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/nerfview/__init__.py", line 1, in <module>
    from .render_panel import (
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/nerfview/render_panel.py", line 27, in <module>
    import matplotlib
ModuleNotFoundError: No module named 'matplotlib'
(difix3d_env) baodinh@asus ~/Difix3D$ pip install matplotlib
Collecting matplotlib
  Using cached matplotlib-3.10.8-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (52 kB)
Collecting contourpy>=1.0.1 (from matplotlib)
  Using cached contourpy-1.3.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (5.5 kB)
Collecting cycler>=0.10 (from matplotlib)
  Using cached cycler-0.12.1-py3-none-any.whl.metadata (3.8 kB)
Collecting fonttools>=4.22.0 (from matplotlib)
  Using cached fonttools-4.61.1-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (114 kB)
Collecting kiwisolver>=1.3.1 (from matplotlib)
  Using cached kiwisolver-1.4.9-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl.metadata (6.3 kB)
Requirement already satisfied: numpy>=1.23 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (2.2.6)
Requirement already satisfied: packaging>=20.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (26.0)
Requirement already satisfied: pillow>=8 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (12.0.0)
Collecting pyparsing>=3 (from matplotlib)
  Using cached pyparsing-3.3.2-py3-none-any.whl.metadata (5.8 kB)
Requirement already satisfied: python-dateutil>=2.7 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (2.9.0.post0)
Requirement already satisfied: six>=1.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from python-dateutil>=2.7->matplotlib) (1.17.0)
Using cached matplotlib-3.10.8-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (8.7 MB)
Using cached contourpy-1.3.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (325 kB)
Using cached cycler-0.12.1-py3-none-any.whl (8.3 kB)
Using cached fonttools-4.61.1-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (4.9 MB)
Using cached kiwisolver-1.4.9-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.6 MB)
Using cached pyparsing-3.3.2-py3-none-any.whl (122 kB)
Installing collected packages: pyparsing, kiwisolver, fonttools, cycler, contourpy, matplotlib
Successfully installed contourpy-1.3.2 cycler-0.12.1 fonttools-4.61.1 kiwisolver-1.4.9 matplotlib-3.10.8 pyparsing-3.3.2
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default     --data_dir data/garden     --data_factor 4     --result_dir outputs/difix3d_result     --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt     --iterations 32000     --save_every 500     --test_every 1000     --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 10, in <module>
    import nerfview
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/nerfview/__init__.py", line 1, in <module>
    from .render_panel import (
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/nerfview/render_panel.py", line 29, in <module>
    import splines
ModuleNotFoundError: No module named 'splines'
(difix3d_env) baodinh@asus ~/Difix3D$ pip install splines
Collecting splines
  Using cached splines-0.3.3-py3-none-any.whl.metadata (1.8 kB)
Requirement already satisfied: NumPy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from splines) (2.2.6)
Using cached splines-0.3.3-py3-none-any.whl (17 kB)
Installing collected packages: splines
Successfully installed splines-0.3.3
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default     --data_dir data/garden     --data_factor 4     --result_dir outputs/difix3d_result     --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt     --iterations 32000     --save_every 500     --test_every 1000     --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 21, in <module>
    from datasets.colmap import Dataset, Parser
  File "/home/baodinh/Difix3D/examples/gsplat/datasets/colmap.py", line 6, in <module>
    import cv2
ModuleNotFoundError: No module named 'cv2'
(difix3d_env) baodinh@asus ~/Difix3D$ pip install cv2
ERROR: Could not find a version that satisfies the requirement cv2 (from versions: none)
ERROR: No matching distribution found for cv2
(difix3d_env) baodinh@asus ~/Difix3D$ pip install opencv-python
Collecting opencv-python
  Downloading opencv_python-4.13.0.90-cp37-abi3-manylinux_2_28_x86_64.whl.metadata (19 kB)
Requirement already satisfied: numpy>=2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from opencv-python) (2.2.6)
Downloading opencv_python-4.13.0.90-cp37-abi3-manylinux_2_28_x86_64.whl (72.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 72.9/72.9 MB 15.2 MB/s  0:00:04
Installing collected packages: opencv-python
Successfully installed opencv-python-4.13.0.90
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default \
    --data_dir data/garden \
    --data_factor 4 \
    --result_dir outputs/difix3d_result \
    --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt \
    --iterations 32000 \
    --save_every 500 \
    --test_every 1000 \
    --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 21, in <module>
    from datasets.colmap import Dataset, Parser
  File "/home/baodinh/Difix3D/examples/gsplat/datasets/colmap.py", line 10, in <module>
    from pycolmap import SceneManager
ModuleNotFoundError: No module named 'pycolmap'
(difix3d_env) baodinh@asus ~/Difix3D$ pip install pycolmap
Collecting pycolmap
  Downloading pycolmap-3.13.0-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (10 kB)
Requirement already satisfied: numpy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from pycolmap) (2.2.6)
Downloading pycolmap-3.13.0-cp310-cp310-manylinux_2_28_x86_64.whl (20.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 20.3/20.3 MB 13.0 MB/s  0:00:01
Installing collected packages: pycolmap
Successfully installed pycolmap-3.13.0
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default     --data_dir data/garden     --data_factor 4     --result_dir outputs/difix3d_result     --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt     --iterations 32000     --save_every 500     --test_every 1000     --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 21, in <module>
    from datasets.colmap import Dataset, Parser
  File "/home/baodinh/Difix3D/examples/gsplat/datasets/colmap.py", line 10, in <module>
    from pycolmap import SceneManager
ImportError: cannot import name 'SceneManager' from 'pycolmap' (/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/pycolmap/__init__.py)
(difix3d_env) baodinh@asus ~/Difix3D$ pip install pycolmap scipy matplotlib imageio tensorboard
Requirement already satisfied: pycolmap in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (3.13.0)
Requirement already satisfied: scipy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (1.15.3)
Requirement already satisfied: matplotlib in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (3.10.8)
Requirement already satisfied: imageio in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (2.37.2)
Collecting tensorboard
  Using cached tensorboard-2.20.0-py3-none-any.whl.metadata (1.8 kB)
Requirement already satisfied: numpy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from pycolmap) (2.2.6)
Requirement already satisfied: contourpy>=1.0.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (1.3.2)
Requirement already satisfied: cycler>=0.10 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (4.61.1)
Requirement already satisfied: kiwisolver>=1.3.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (1.4.9)
Requirement already satisfied: packaging>=20.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (26.0)
Requirement already satisfied: pillow>=8 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (12.0.0)
Requirement already satisfied: pyparsing>=3 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (3.3.2)
Requirement already satisfied: python-dateutil>=2.7 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib) (2.9.0.post0)
Collecting absl-py>=0.4 (from tensorboard)
  Using cached absl_py-2.3.1-py3-none-any.whl.metadata (3.3 kB)
Collecting grpcio>=1.48.2 (from tensorboard)
  Using cached grpcio-1.76.0-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (3.7 kB)
Collecting markdown>=2.6.8 (from tensorboard)
  Downloading markdown-3.10.1-py3-none-any.whl.metadata (5.1 kB)
Requirement already satisfied: protobuf!=4.24.0,>=3.19.6 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tensorboard) (6.33.4)
Requirement already satisfied: setuptools>=41.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tensorboard) (80.10.1)
Collecting tensorboard-data-server<0.8.0,>=0.7.0 (from tensorboard)
  Using cached tensorboard_data_server-0.7.2-py3-none-manylinux_2_31_x86_64.whl.metadata (1.1 kB)
Collecting werkzeug>=1.0.1 (from tensorboard)
  Downloading werkzeug-3.1.5-py3-none-any.whl.metadata (4.0 kB)
Requirement already satisfied: typing-extensions~=4.12 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from grpcio>=1.48.2->tensorboard) (4.15.0)
Requirement already satisfied: six>=1.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from python-dateutil>=2.7->matplotlib) (1.17.0)
Requirement already satisfied: markupsafe>=2.1.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from werkzeug>=1.0.1->tensorboard) (2.1.5)
Using cached tensorboard-2.20.0-py3-none-any.whl (5.5 MB)
Using cached tensorboard_data_server-0.7.2-py3-none-manylinux_2_31_x86_64.whl (6.6 MB)
Using cached absl_py-2.3.1-py3-none-any.whl (135 kB)
Using cached grpcio-1.76.0-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (6.6 MB)
Downloading markdown-3.10.1-py3-none-any.whl (107 kB)
Downloading werkzeug-3.1.5-py3-none-any.whl (225 kB)
Installing collected packages: werkzeug, tensorboard-data-server, markdown, grpcio, absl-py, tensorboard
Successfully installed absl-py-2.3.1 grpcio-1.76.0 markdown-3.10.1 tensorboard-2.20.0 tensorboard-data-server-0.7.2 werkzeug-3.1.5
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default     --data_dir data/garden     --data_factor 4     --result_dir outputs/difix3d_result     --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt     --iterations 32000     --save_every 500     --test_every 1000     --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 21, in <module>
    from datasets.colmap import Dataset, Parser
  File "/home/baodinh/Difix3D/examples/gsplat/datasets/colmap.py", line 10, in <module>
    from pycolmap import SceneManager
ImportError: cannot import name 'SceneManager' from 'pycolmap' (/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/pycolmap/__init__.py)
(difix3d_env) baodinh@asus ~/Difix3D$ # 1. Gỡ bản hiện tại ra
pip uninstall pycolmap -y

# 2. Cài lại bản 0.4.0 (Bản tương thích với SceneManager)
pip install pycolmap==0.4.0
Found existing installation: pycolmap 3.13.0
Uninstalling pycolmap-3.13.0:
  Successfully uninstalled pycolmap-3.13.0
Collecting pycolmap==0.4.0
  Downloading pycolmap-0.4.0-cp310-cp310-manylinux2014_x86_64.whl.metadata (12 kB)
Downloading pycolmap-0.4.0-cp310-cp310-manylinux2014_x86_64.whl (14.4 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 14.4/14.4 MB 5.2 MB/s  0:00:02
Installing collected packages: pycolmap
Successfully installed pycolmap-0.4.0
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default     --data_dir data/garden     --data_factor 4     --result_dir outputs/difix3d_result     --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt     --iterations 32000     --save_every 500     --test_every 1000     --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 21, in <module>
    from datasets.colmap import Dataset, Parser
  File "/home/baodinh/Difix3D/examples/gsplat/datasets/colmap.py", line 10, in <module>
    from pycolmap import SceneManager
ImportError: cannot import name 'SceneManager' from 'pycolmap' (/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/pycolmap.cpython-310-x86_64-linux-gnu.so)
(difix3d_env) baodinh@asus ~/Difix3D$ pip uninstall pycolmap nerfview opencv-python numpy tyro -y
Found existing installation: pycolmap 0.4.0
Uninstalling pycolmap-0.4.0:
  Successfully uninstalled pycolmap-0.4.0
Found existing installation: nerfview 0.1.3
Uninstalling nerfview-0.1.3:
  Successfully uninstalled nerfview-0.1.3
Found existing installation: opencv-python 4.13.0.90
Uninstalling opencv-python-4.13.0.90:
  Successfully uninstalled opencv-python-4.13.0.90
Found existing installation: numpy 2.2.6
Uninstalling numpy-2.2.6:
  Successfully uninstalled numpy-2.2.6
Found existing installation: tyro 1.0.5
Uninstalling tyro-1.0.5:
  Successfully uninstalled tyro-1.0.5
(difix3d_env) baodinh@asus ~/Difix3D$ nano requirements_gsplat.txt
(difix3d_env) baodinh@asus ~/Difix3D$ pip install -r requirements_gsplat.txt
Collecting git+https://github.com/nerfstudio-project/nerfview@4538024fe0d15fd1a0e4d760f3695fc44ca72787 (from -r requirements_gsplat.txt (line 15))
  Cloning https://github.com/nerfstudio-project/nerfview (to revision 4538024fe0d15fd1a0e4d760f3695fc44ca72787) to /tmp/pip-req-build-irwnnhay
  Running command git clone --filter=blob:none --quiet https://github.com/nerfstudio-project/nerfview /tmp/pip-req-build-irwnnhay
  Running command git rev-parse -q --verify 'sha^4538024fe0d15fd1a0e4d760f3695fc44ca72787'
  Running command git fetch -q https://github.com/nerfstudio-project/nerfview 4538024fe0d15fd1a0e4d760f3695fc44ca72787
  Running command git checkout -q 4538024fe0d15fd1a0e4d760f3695fc44ca72787
  Resolved https://github.com/nerfstudio-project/nerfview to commit 4538024fe0d15fd1a0e4d760f3695fc44ca72787
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Collecting numpy<2.0.0 (from -r requirements_gsplat.txt (line 2))
  Using cached numpy-1.26.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (61 kB)
Collecting opencv-python (from -r requirements_gsplat.txt (line 3))
  Using cached opencv_python-4.13.0.90-cp37-abi3-manylinux_2_28_x86_64.whl.metadata (19 kB)
Collecting tyro>=0.8.8 (from -r requirements_gsplat.txt (line 4))
  Using cached tyro-1.0.5-py3-none-any.whl.metadata (12 kB)
Requirement already satisfied: tqdm in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 5)) (4.67.1)
Requirement already satisfied: matplotlib in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 7)) (3.10.8)
Collecting scikit-learn (from -r requirements_gsplat.txt (line 8))
  Using cached scikit_learn-1.7.2-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (11 kB)
Requirement already satisfied: scipy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 9)) (1.15.3)
Requirement already satisfied: tensorboard in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 10)) (2.20.0)
Requirement already satisfied: viser in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 14)) (1.0.21)
ERROR: Ignored the following versions that require a different python version: 1.8.0 Requires-Python >=3.11; 1.8.0rc1 Requires-Python >=3.11; 2.3.0 Requires-Python >=3.11; 2.3.1 Requires-Python >=3.11; 2.3.2 Requires-Python >=3.11; 2.3.3 Requires-Python >=3.11; 2.3.4 Requires-Python >=3.11; 2.3.5 Requires-Python >=3.11; 2.4.0 Requires-Python >=3.11; 2.4.0rc1 Requires-Python >=3.11; 2.4.1 Requires-Python >=3.11
ERROR: Could not find a version that satisfies the requirement pycolmap==0.3.0 (from versions: 0.4.0, 0.5.0, 0.6.0, 0.6.1, 3.10.0, 3.11.0, 3.11.1, 3.12.0, 3.12.1, 3.12.3, 3.12.4, 3.12.5, 3.12.6, 3.13.0)
ERROR: No matching distribution found for pycolmap==0.3.0
(difix3d_env) baodinh@asus ~/Difix3D$ nano requirements_gsplat.txt
(difix3d_env) baodinh@asus ~/Difix3D$ pip install -r requirements_gsplat.txt
Collecting git+https://github.com/rmbrualla/pycolmap@cc7ea4b7301720ac29287dbe450952511b32125e (from -r requirements_gsplat.txt (line 4))
  Cloning https://github.com/rmbrualla/pycolmap (to revision cc7ea4b7301720ac29287dbe450952511b32125e) to /tmp/pip-req-build-p216psbr
  Running command git clone --filter=blob:none --quiet https://github.com/rmbrualla/pycolmap /tmp/pip-req-build-p216psbr
  Running command git rev-parse -q --verify 'sha^cc7ea4b7301720ac29287dbe450952511b32125e'
  Running command git fetch -q https://github.com/rmbrualla/pycolmap cc7ea4b7301720ac29287dbe450952511b32125e
  Resolved https://github.com/rmbrualla/pycolmap to commit cc7ea4b7301720ac29287dbe450952511b32125e
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Collecting git+https://github.com/nerfstudio-project/nerfview@4538024fe0d15fd1a0e4d760f3695fc44ca72787 (from -r requirements_gsplat.txt (line 9))
  Cloning https://github.com/nerfstudio-project/nerfview (to revision 4538024fe0d15fd1a0e4d760f3695fc44ca72787) to /tmp/pip-req-build-tq8jvmeh
  Running command git clone --filter=blob:none --quiet https://github.com/nerfstudio-project/nerfview /tmp/pip-req-build-tq8jvmeh
  Running command git rev-parse -q --verify 'sha^4538024fe0d15fd1a0e4d760f3695fc44ca72787'
  Running command git fetch -q https://github.com/nerfstudio-project/nerfview 4538024fe0d15fd1a0e4d760f3695fc44ca72787
  Running command git checkout -q 4538024fe0d15fd1a0e4d760f3695fc44ca72787
  Resolved https://github.com/nerfstudio-project/nerfview to commit 4538024fe0d15fd1a0e4d760f3695fc44ca72787
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Requirement already satisfied: viser in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 8)) (1.0.21)
Collecting numpy<2.0.0 (from -r requirements_gsplat.txt (line 11))
  Using cached numpy-1.26.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (61 kB)
Collecting scikit-learn (from -r requirements_gsplat.txt (line 12))
  Using cached scikit_learn-1.7.2-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (11 kB)
Requirement already satisfied: tqdm in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 13)) (4.67.1)
Collecting opencv-python (from -r requirements_gsplat.txt (line 15))
  Using cached opencv_python-4.13.0.90-cp37-abi3-manylinux_2_28_x86_64.whl.metadata (19 kB)
Collecting tyro>=0.8.8 (from -r requirements_gsplat.txt (line 16))
  Using cached tyro-1.0.5-py3-none-any.whl.metadata (12 kB)
Requirement already satisfied: Pillow in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 17)) (12.0.0)
Requirement already satisfied: tensorboard in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 18)) (2.20.0)
Collecting tensorly (from -r requirements_gsplat.txt (line 19))
  Using cached tensorly-0.9.0-py3-none-any.whl.metadata (8.6 kB)
Requirement already satisfied: pyyaml in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 20)) (6.0.3)
Requirement already satisfied: matplotlib in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 21)) (3.10.8)
Requirement already satisfied: splines in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 24)) (0.3.3)
Requirement already satisfied: imageio[ffmpeg] in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 10)) (2.37.2)
Requirement already satisfied: torchmetrics[image] in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from -r requirements_gsplat.txt (line 14)) (1.8.2)
Requirement already satisfied: scipy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from pycolmap==0.0.1->-r requirements_gsplat.txt (line 4)) (1.15.3)
Requirement already satisfied: msgspec<1.0.0,>=0.18.6 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser->-r requirements_gsplat.txt (line 8)) (0.20.0)
Requirement already satisfied: nodeenv<2.0.0,>=1.9.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser->-r requirements_gsplat.txt (line 8)) (1.10.0)
Requirement already satisfied: requests<3.0.0,>=2.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser->-r requirements_gsplat.txt (line 8)) (2.32.5)
Requirement already satisfied: rich<15.0.0,>=13.3.3 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser->-r requirements_gsplat.txt (line 8)) (14.3.1)
Requirement already satisfied: trimesh<5.0.0,>=3.21.7 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser->-r requirements_gsplat.txt (line 8)) (4.11.1)
Requirement already satisfied: typing-extensions>=4.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser->-r requirements_gsplat.txt (line 8)) (4.15.0)
Requirement already satisfied: websockets<16.0.0,>=13.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser->-r requirements_gsplat.txt (line 8)) (15.0.1)
Requirement already satisfied: yourdfpy<1.0.0,>=0.0.53 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser->-r requirements_gsplat.txt (line 8)) (0.0.60)
Requirement already satisfied: zstandard<1.0.0,>=0.20.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from viser->-r requirements_gsplat.txt (line 8)) (0.25.0)
Requirement already satisfied: charset_normalizer<4,>=2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser->-r requirements_gsplat.txt (line 8)) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser->-r requirements_gsplat.txt (line 8)) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser->-r requirements_gsplat.txt (line 8)) (2.6.3)
Requirement already satisfied: certifi>=2017.4.17 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from requests<3.0.0,>=2.0.0->viser->-r requirements_gsplat.txt (line 8)) (2026.1.4)
Requirement already satisfied: markdown-it-py>=2.2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from rich<15.0.0,>=13.3.3->viser->-r requirements_gsplat.txt (line 8)) (4.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from rich<15.0.0,>=13.3.3->viser->-r requirements_gsplat.txt (line 8)) (2.19.2)
Requirement already satisfied: lxml in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (6.0.2)
Requirement already satisfied: six in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (1.17.0)
Requirement already satisfied: imageio-ffmpeg in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from imageio[ffmpeg]->-r requirements_gsplat.txt (line 10)) (0.6.0)
Requirement already satisfied: psutil in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from imageio[ffmpeg]->-r requirements_gsplat.txt (line 10)) (7.2.1)
Collecting joblib>=1.2.0 (from scikit-learn->-r requirements_gsplat.txt (line 12))
  Using cached joblib-1.5.3-py3-none-any.whl.metadata (5.5 kB)
Collecting threadpoolctl>=3.1.0 (from scikit-learn->-r requirements_gsplat.txt (line 12))
  Using cached threadpoolctl-3.6.0-py3-none-any.whl.metadata (13 kB)
Requirement already satisfied: packaging>17.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (26.0)
Requirement already satisfied: torch>=2.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (2.5.1+cu121)
Requirement already satisfied: lightning-utilities>=0.8.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (0.15.2)
Collecting torch-fidelity<=0.4.0 (from torchmetrics[image]->-r requirements_gsplat.txt (line 14))
  Using cached torch_fidelity-0.3.0-py3-none-any.whl.metadata (2.0 kB)
Requirement already satisfied: torchvision>=0.15.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (0.20.1+cu121)
INFO: pip is looking at multiple versions of opencv-python to determine which version is compatible with other requirements. This could take a while.
Collecting opencv-python (from -r requirements_gsplat.txt (line 15))
  Using cached opencv_python-4.12.0.88-cp37-abi3-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (19 kB)
  Using cached opencv_python-4.11.0.86-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (20 kB)
Requirement already satisfied: docstring-parser>=0.15 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tyro>=0.8.8->-r requirements_gsplat.txt (line 16)) (0.17.0)
Requirement already satisfied: typeguard>=4.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tyro>=0.8.8->-r requirements_gsplat.txt (line 16)) (4.4.4)
Requirement already satisfied: absl-py>=0.4 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tensorboard->-r requirements_gsplat.txt (line 18)) (2.3.1)
Requirement already satisfied: grpcio>=1.48.2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tensorboard->-r requirements_gsplat.txt (line 18)) (1.76.0)
Requirement already satisfied: markdown>=2.6.8 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tensorboard->-r requirements_gsplat.txt (line 18)) (3.10.1)
Requirement already satisfied: protobuf!=4.24.0,>=3.19.6 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tensorboard->-r requirements_gsplat.txt (line 18)) (6.33.4)
Requirement already satisfied: setuptools>=41.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tensorboard->-r requirements_gsplat.txt (line 18)) (80.10.1)
Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tensorboard->-r requirements_gsplat.txt (line 18)) (0.7.2)
Requirement already satisfied: werkzeug>=1.0.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from tensorboard->-r requirements_gsplat.txt (line 18)) (3.1.5)
Requirement already satisfied: contourpy>=1.0.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib->-r requirements_gsplat.txt (line 21)) (1.3.2)
Requirement already satisfied: cycler>=0.10 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib->-r requirements_gsplat.txt (line 21)) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib->-r requirements_gsplat.txt (line 21)) (4.61.1)
Requirement already satisfied: kiwisolver>=1.3.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib->-r requirements_gsplat.txt (line 21)) (1.4.9)
Requirement already satisfied: pyparsing>=3 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib->-r requirements_gsplat.txt (line 21)) (3.3.2)
Requirement already satisfied: python-dateutil>=2.7 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from matplotlib->-r requirements_gsplat.txt (line 21)) (2.9.0.post0)
Requirement already satisfied: mdurl~=0.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from markdown-it-py>=2.2.0->rich<15.0.0,>=13.3.3->viser->-r requirements_gsplat.txt (line 8)) (0.1.2)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (3.20.0)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (3.1.6)
Requirement already satisfied: fsspec in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (2025.12.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (2.21.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (12.1.105)
Requirement already satisfied: triton==3.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (3.1.0)
Requirement already satisfied: sympy==1.13.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (1.13.1)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (12.9.86)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy==1.13.1->torch>=2.0.0->torchmetrics[image]->-r requirements_gsplat.txt (line 14)) (1.3.0)
Requirement already satisfied: colorlog in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (6.10.1)
Requirement already satisfied: manifold3d>=2.3.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (3.3.2)
Requirement already satisfied: jsonschema in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (4.26.0)
Requirement already satisfied: svg.path in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (7.0)
Requirement already satisfied: pycollada in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (0.9.3)
Requirement already satisfied: shapely in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (2.1.2)
Requirement already satisfied: xxhash in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (3.6.0)
Requirement already satisfied: rtree in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (1.4.1)
Requirement already satisfied: httpx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (0.28.1)
Requirement already satisfied: embreex in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (2.17.7.post7)
Requirement already satisfied: vhacdx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (0.0.10)
Requirement already satisfied: mapbox_earcut>=1.0.2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (2.0.0)
Requirement already satisfied: markupsafe>=2.1.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from werkzeug>=1.0.1->tensorboard->-r requirements_gsplat.txt (line 18)) (2.1.5)
Requirement already satisfied: anyio in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (4.12.1)
Requirement already satisfied: httpcore==1.* in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (1.0.9)
Requirement already satisfied: h11>=0.16 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from httpcore==1.*->httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (0.16.0)
Requirement already satisfied: exceptiongroup>=1.0.2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from anyio->httpx->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (1.3.1)
Requirement already satisfied: attrs>=22.2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (25.4.0)
Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (2025.9.1)
Requirement already satisfied: referencing>=0.28.4 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (0.37.0)
Requirement already satisfied: rpds-py>=0.25.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jsonschema->trimesh[easy]>=3.11.2->yourdfpy<1.0.0,>=0.0.53->viser->-r requirements_gsplat.txt (line 8)) (0.30.0)
Using cached numpy-1.26.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (18.2 MB)
Using cached scikit_learn-1.7.2-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (9.7 MB)
Using cached torch_fidelity-0.3.0-py3-none-any.whl (37 kB)
Using cached opencv_python-4.11.0.86-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (63.0 MB)
Using cached tyro-1.0.5-py3-none-any.whl (181 kB)
Using cached tensorly-0.9.0-py3-none-any.whl (7.4 MB)
Using cached joblib-1.5.3-py3-none-any.whl (309 kB)
Using cached threadpoolctl-3.6.0-py3-none-any.whl (18 kB)
Building wheels for collected packages: pycolmap, nerfview
  Building wheel for pycolmap (pyproject.toml) ... done
  Created wheel for pycolmap: filename=pycolmap-0.0.1-py3-none-any.whl size=16589 sha256=3dfb141b3b6cbb9faa869ca2507970b3ecd88770e3b1d3c47f6dc3815ba6fc67
  Stored in directory: /home/baodinh/.cache/pip/wheels/62/6a/b7/254d1a6cf1e2835bd207ed985862dc823904bd4d3e2377d441
  Building wheel for nerfview (pyproject.toml) ... done
  Created wheel for nerfview: filename=nerfview-0.1.2-py3-none-any.whl size=19709 sha256=ed56007e1c41b70b66e205b33beae137bea745bfedd778f9fa0effcadc44b742
  Stored in directory: /home/baodinh/.cache/pip/wheels/15/2b/fd/64cd24f4f7b979851f4879c026a0c4937d4dc0b8b684f6f36e
Successfully built pycolmap nerfview
Installing collected packages: threadpoolctl, numpy, joblib, tyro, opencv-python, tensorly, scikit-learn, pycolmap, torch-fidelity, nerfview
Successfully installed joblib-1.5.3 nerfview-0.1.2 numpy-1.26.4 opencv-python-4.11.0.86 pycolmap-0.0.1 scikit-learn-1.7.2 tensorly-0.9.0 threadpoolctl-3.6.0 torch-fidelity-0.3.0 tyro-1.0.5
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default     --data_dir data/garden     --data_factor 4     --result_dir outputs/difix3d_result     --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt     --iterations 32000     --save_every 500     --test_every 1000     --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 31, in <module>
    from fused_ssim import fused_ssim
ModuleNotFoundError: No module named 'fused_ssim'
(difix3d_env) baodinh@asus ~/Difix3D$ # 1. Cài ninja (Công cụ hỗ trợ biên dịch code C++ nhanh hơn)
pip install ninja

# 2. Cài đặt fused_ssim từ mã nguồn gốc
pip install git+https://github.com/rahul-goel/fused-ssim
Requirement already satisfied: ninja in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (1.13.0)
Collecting git+https://github.com/rahul-goel/fused-ssim
  Cloning https://github.com/rahul-goel/fused-ssim to /tmp/pip-req-build-m5kdhd88
  Running command git clone --filter=blob:none --quiet https://github.com/rahul-goel/fused-ssim /tmp/pip-req-build-m5kdhd88
  Resolved https://github.com/rahul-goel/fused-ssim to commit 0ac916a05f48f8e477dc8ce1651a346b65ce2072
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Requirement already satisfied: torch>=2.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from fused-ssim==1.0.0) (2.5.1+cu121)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (3.20.0)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (4.15.0)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (3.1.6)
Requirement already satisfied: fsspec in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (2025.12.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (2.21.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (12.1.105)
Requirement already satisfied: triton==3.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (3.1.0)
Requirement already satisfied: sympy==1.13.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch>=2.0.0->fused-ssim==1.0.0) (1.13.1)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch>=2.0.0->fused-ssim==1.0.0) (12.9.86)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy==1.13.1->torch>=2.0.0->fused-ssim==1.0.0) (1.3.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jinja2->torch>=2.0.0->fused-ssim==1.0.0) (2.1.5)
Building wheels for collected packages: fused-ssim
  Building wheel for fused-ssim (pyproject.toml) ... done
  Created wheel for fused-ssim: filename=fused_ssim-1.0.0-cp310-cp310-linux_x86_64.whl size=158287 sha256=b06a873f3759409bcb5dd38c373299e8989cb0649657d9431d4eee6f00c4572e
  Stored in directory: /tmp/pip-ephem-wheel-cache-glad970c/wheels/ab/6e/5f/1691340c88bd2bb55b7c5905183d398dbc079b5e4e01adf9ee
Successfully built fused-ssim
Installing collected packages: fused-ssim
Successfully installed fused-ssim-1.0.0
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default     --data_dir data/garden     --data_factor 4     --result_dir outputs/difix3d_result     --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt     --iterations 32000     --save_every 500     --test_every 1000     --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 31, in <module>
    from fused_ssim import fused_ssim
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/fused_ssim/__init__.py", line 6, in <module>
    from fused_ssim_cuda import fusedssim, fusedssim_backward, fusedssim3d, fusedssim_backward3d
ImportError: /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/fused_ssim_cuda.cpython-310-x86_64-linux-gnu.so: undefined symbol: _ZN3c104cuda29c10_cuda_check_implementationEiPKcS2_jb
(difix3d_env) baodinh@asus ~/Difix3D$ pip uninstall fused_ssim -y
Found existing installation: fused-ssim 1.0.0
Uninstalling fused-ssim-1.0.0:
  Successfully uninstalled fused-ssim-1.0.0
(difix3d_env) baodinh@asus ~/Difix3D$ pip install git+https://github.com/rahul-goel/fused-ssim --force-reinstall --no-cache-dir --no-build-isolation
Collecting git+https://github.com/rahul-goel/fused-ssim
  Cloning https://github.com/rahul-goel/fused-ssim to /tmp/pip-req-build-gpzz8s0w
  Running command git clone --filter=blob:none --quiet https://github.com/rahul-goel/fused-ssim /tmp/pip-req-build-gpzz8s0w
  Resolved https://github.com/rahul-goel/fused-ssim to commit 0ac916a05f48f8e477dc8ce1651a346b65ce2072
  Preparing metadata (pyproject.toml) ... done
Collecting torch>=2.0.0 (from fused-ssim==1.0.0)
  Downloading torch-2.10.0-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (31 kB)
Collecting filelock (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading filelock-3.20.3-py3-none-any.whl.metadata (2.1 kB)
Collecting typing-extensions>=4.10.0 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Collecting sympy>=1.13.3 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading sympy-1.14.0-py3-none-any.whl.metadata (12 kB)
Collecting networkx>=2.5.1 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading networkx-3.4.2-py3-none-any.whl.metadata (6.3 kB)
Collecting jinja2 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)
Collecting fsspec>=0.8.5 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading fsspec-2026.1.0-py3-none-any.whl.metadata (10 kB)
Collecting cuda-bindings==12.9.4 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading cuda_bindings-12.9.4-cp310-cp310-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl.metadata (2.6 kB)
Collecting nvidia-cuda-nvrtc-cu12==12.8.93 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cuda_nvrtc_cu12-12.8.93-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cuda-runtime-cu12==12.8.90 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cuda_runtime_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cuda-cupti-cu12==12.8.90 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cuda_cupti_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cudnn-cu12==9.10.2.21 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cudnn_cu12-9.10.2.21-py3-none-manylinux_2_27_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-cublas-cu12==12.8.4.1 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cublas_cu12-12.8.4.1-py3-none-manylinux_2_27_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cufft-cu12==11.3.3.83 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cufft_cu12-11.3.3.83-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-curand-cu12==10.3.9.90 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_curand_cu12-10.3.9.90-py3-none-manylinux_2_27_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cusolver-cu12==11.7.3.90 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cusolver_cu12-11.7.3.90-py3-none-manylinux_2_27_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-cusparse-cu12==12.5.8.93 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cusparse_cu12-12.5.8.93-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-cusparselt-cu12==0.7.1 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cusparselt_cu12-0.7.1-py3-none-manylinux2014_x86_64.whl.metadata (7.0 kB)
Collecting nvidia-nccl-cu12==2.27.5 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_nccl_cu12-2.27.5-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (2.0 kB)
Collecting nvidia-nvshmem-cu12==3.4.5 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_nvshmem_cu12-3.4.5-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (2.1 kB)
Collecting nvidia-nvtx-cu12==12.8.90 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_nvtx_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-nvjitlink-cu12==12.8.93 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_nvjitlink_cu12-12.8.93-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cufile-cu12==1.13.1.3 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cufile_cu12-1.13.1.3-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.7 kB)
Collecting triton==3.6.0 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading triton-3.6.0-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (1.7 kB)
Collecting cuda-pathfinder~=1.1 (from cuda-bindings==12.9.4->torch>=2.0.0->fused-ssim==1.0.0)
  Downloading cuda_pathfinder-1.3.3-py3-none-any.whl.metadata (1.9 kB)
Collecting mpmath<1.4,>=1.1.0 (from sympy>=1.13.3->torch>=2.0.0->fused-ssim==1.0.0)
  Downloading mpmath-1.3.0-py3-none-any.whl.metadata (8.6 kB)
Collecting MarkupSafe>=2.0 (from jinja2->torch>=2.0.0->fused-ssim==1.0.0)
  Downloading markupsafe-3.0.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (2.7 kB)
Downloading torch-2.10.0-cp310-cp310-manylinux_2_28_x86_64.whl (915.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 915.6/915.6 MB 27.4 MB/s  0:00:50
Downloading cuda_bindings-12.9.4-cp310-cp310-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl (12.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.1/12.1 MB 29.0 MB/s  0:00:00
Downloading nvidia_cublas_cu12-12.8.4.1-py3-none-manylinux_2_27_x86_64.whl (594.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 594.3/594.3 MB 33.4 MB/s  0:00:18
Downloading nvidia_cuda_cupti_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (10.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.2/10.2 MB 28.1 MB/s  0:00:00
Downloading nvidia_cuda_nvrtc_cu12-12.8.93-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl (88.0 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 88.0/88.0 MB 30.0 MB/s  0:00:02
Downloading nvidia_cuda_runtime_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (954 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 954.8/954.8 kB 17.0 MB/s  0:00:00
Downloading nvidia_cudnn_cu12-9.10.2.21-py3-none-manylinux_2_27_x86_64.whl (706.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 706.8/706.8 MB 32.1 MB/s  0:00:21
Downloading nvidia_cufft_cu12-11.3.3.83-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (193.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 193.1/193.1 MB 30.7 MB/s  0:00:06
Downloading nvidia_cufile_cu12-1.13.1.3-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (1.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 13.6 MB/s  0:00:00
Downloading nvidia_curand_cu12-10.3.9.90-py3-none-manylinux_2_27_x86_64.whl (63.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 63.6/63.6 MB 30.9 MB/s  0:00:02
Downloading nvidia_cusolver_cu12-11.7.3.90-py3-none-manylinux_2_27_x86_64.whl (267.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 267.5/267.5 MB 20.9 MB/s  0:00:12
Downloading nvidia_cusparse_cu12-12.5.8.93-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (288.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 288.2/288.2 MB 17.0 MB/s  0:00:17
Downloading nvidia_cusparselt_cu12-0.7.1-py3-none-manylinux2014_x86_64.whl (287.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 287.2/287.2 MB 15.3 MB/s  0:00:18
Downloading nvidia_nccl_cu12-2.27.5-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (322.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 322.3/322.3 MB 15.2 MB/s  0:00:20
Downloading nvidia_nvjitlink_cu12-12.8.93-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl (39.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 39.3/39.3 MB 13.0 MB/s  0:00:03
Downloading nvidia_nvshmem_cu12-3.4.5-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (139.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 139.1/139.1 MB 13.0 MB/s  0:00:10
Downloading nvidia_nvtx_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (89 kB)
Downloading triton-3.6.0-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (188.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 188.1/188.1 MB 13.7 MB/s  0:00:13
Downloading cuda_pathfinder-1.3.3-py3-none-any.whl (27 kB)
Downloading fsspec-2026.1.0-py3-none-any.whl (201 kB)
Downloading networkx-3.4.2-py3-none-any.whl (1.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.7/1.7 MB 2.5 MB/s  0:00:00
Downloading sympy-1.14.0-py3-none-any.whl (6.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.3/6.3 MB 2.7 MB/s  0:00:02
Downloading mpmath-1.3.0-py3-none-any.whl (536 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 536.2/536.2 kB 4.3 MB/s  0:00:00
Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
Downloading filelock-3.20.3-py3-none-any.whl (16 kB)
Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)
Downloading markupsafe-3.0.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (20 kB)
Building wheels for collected packages: fused-ssim
  Building wheel for fused-ssim (pyproject.toml) ... done
  Created wheel for fused-ssim: filename=fused_ssim-1.0.0-cp310-cp310-linux_x86_64.whl size=141876 sha256=606dd949c1a9952b8b3d4b8ac8e0470463a70475bf18e5ecdc37dbd3a42deab9
  Stored in directory: /tmp/pip-ephem-wheel-cache-8m3ykc8m/wheels/ab/6e/5f/1691340c88bd2bb55b7c5905183d398dbc079b5e4e01adf9ee
Successfully built fused-ssim
Installing collected packages: nvidia-cusparselt-cu12, mpmath, typing-extensions, triton, sympy, nvidia-nvtx-cu12, nvidia-nvshmem-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufile-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, networkx, MarkupSafe, fsspec, filelock, cuda-pathfinder, nvidia-cusparse-cu12, nvidia-cufft-cu12, nvidia-cudnn-cu12, jinja2, cuda-bindings, nvidia-cusolver-cu12, torch, fused-ssim
  Attempting uninstall: mpmath
    Found existing installation: mpmath 1.3.0
    Uninstalling mpmath-1.3.0:
      Successfully uninstalled mpmath-1.3.0
  Attempting uninstall: typing-extensions
    Found existing installation: typing_extensions 4.15.0
    Uninstalling typing_extensions-4.15.0:
      Successfully uninstalled typing_extensions-4.15.0
  Attempting uninstall: triton
    Found existing installation: triton 3.1.0
    Uninstalling triton-3.1.0:
      Successfully uninstalled triton-3.1.0
  Attempting uninstall: sympy
    Found existing installation: sympy 1.13.1
    Uninstalling sympy-1.13.1:
      Successfully uninstalled sympy-1.13.1
  Attempting uninstall: nvidia-nvtx-cu12
    Found existing installation: nvidia-nvtx-cu12 12.1.105
    Uninstalling nvidia-nvtx-cu12-12.1.105:
      Successfully uninstalled nvidia-nvtx-cu12-12.1.105
  Attempting uninstall: nvidia-nvjitlink-cu12
    Found existing installation: nvidia-nvjitlink-cu12 12.9.86
    Uninstalling nvidia-nvjitlink-cu12-12.9.86:
      Successfully uninstalled nvidia-nvjitlink-cu12-12.9.86
  Attempting uninstall: nvidia-nccl-cu12
    Found existing installation: nvidia-nccl-cu12 2.21.5
    Uninstalling nvidia-nccl-cu12-2.21.5:
      Successfully uninstalled nvidia-nccl-cu12-2.21.5
  Attempting uninstall: nvidia-curand-cu12
    Found existing installation: nvidia-curand-cu12 10.3.2.106
    Uninstalling nvidia-curand-cu12-10.3.2.106:
      Successfully uninstalled nvidia-curand-cu12-10.3.2.106
  Attempting uninstall: nvidia-cuda-runtime-cu12
    Found existing installation: nvidia-cuda-runtime-cu12 12.1.105
    Uninstalling nvidia-cuda-runtime-cu12-12.1.105:
      Successfully uninstalled nvidia-cuda-runtime-cu12-12.1.105
  Attempting uninstall: nvidia-cuda-nvrtc-cu12
    Found existing installation: nvidia-cuda-nvrtc-cu12 12.1.105
    Uninstalling nvidia-cuda-nvrtc-cu12-12.1.105:
      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.1.105
  Attempting uninstall: nvidia-cuda-cupti-cu12
    Found existing installation: nvidia-cuda-cupti-cu12 12.1.105
    Uninstalling nvidia-cuda-cupti-cu12-12.1.105:
      Successfully uninstalled nvidia-cuda-cupti-cu12-12.1.105
  Attempting uninstall: nvidia-cublas-cu12
    Found existing installation: nvidia-cublas-cu12 12.1.3.1
    Uninstalling nvidia-cublas-cu12-12.1.3.1:
      Successfully uninstalled nvidia-cublas-cu12-12.1.3.1
  Attempting uninstall: networkx
    Found existing installation: networkx 3.4.2
    Uninstalling networkx-3.4.2:
      Successfully uninstalled networkx-3.4.2
  Attempting uninstall: MarkupSafe
    Found existing installation: MarkupSafe 2.1.5
    Uninstalling MarkupSafe-2.1.5:
      Successfully uninstalled MarkupSafe-2.1.5
  Attempting uninstall: fsspec
    Found existing installation: fsspec 2025.12.0
    Uninstalling fsspec-2025.12.0:
      Successfully uninstalled fsspec-2025.12.0
  Attempting uninstall: filelock
    Found existing installation: filelock 3.20.0
    Uninstalling filelock-3.20.0:
      Successfully uninstalled filelock-3.20.0
  Attempting uninstall: nvidia-cusparse-cu12
    Found existing installation: nvidia-cusparse-cu12 12.1.0.106
    Uninstalling nvidia-cusparse-cu12-12.1.0.106:
      Successfully uninstalled nvidia-cusparse-cu12-12.1.0.106
  Attempting uninstall: nvidia-cufft-cu12
    Found existing installation: nvidia-cufft-cu12 11.0.2.54
    Uninstalling nvidia-cufft-cu12-11.0.2.54:
      Successfully uninstalled nvidia-cufft-cu12-11.0.2.54
  Attempting uninstall: nvidia-cudnn-cu12
    Found existing installation: nvidia-cudnn-cu12 9.1.0.70
    Uninstalling nvidia-cudnn-cu12-9.1.0.70:
      Successfully uninstalled nvidia-cudnn-cu12-9.1.0.70
  Attempting uninstall: jinja2
    Found existing installation: Jinja2 3.1.6
    Uninstalling Jinja2-3.1.6:
      Successfully uninstalled Jinja2-3.1.6
  Attempting uninstall: nvidia-cusolver-cu12
    Found existing installation: nvidia-cusolver-cu12 11.4.5.107
    Uninstalling nvidia-cusolver-cu12-11.4.5.107:
      Successfully uninstalled nvidia-cusolver-cu12-11.4.5.107
  Attempting uninstall: torch
    Found existing installation: torch 2.5.1+cu121
    Uninstalling torch-2.5.1+cu121:
      Successfully uninstalled torch-2.5.1+cu121
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
torchaudio 2.5.1+cu121 requires torch==2.5.1, but you have torch 2.10.0 which is incompatible.
torchvision 0.20.1+cu121 requires torch==2.5.1, but you have torch 2.10.0 which is incompatible.
xformers 0.0.29.post1 requires torch==2.5.1, but you have torch 2.10.0 which is incompatible.
Successfully installed MarkupSafe-3.0.3 cuda-bindings-12.9.4 cuda-pathfinder-1.3.3 filelock-3.20.3 fsspec-2026.1.0 fused-ssim-1.0.0 jinja2-3.1.6 mpmath-1.3.0 networkx-3.4.2 nvidia-cublas-cu12-12.8.4.1 nvidia-cuda-cupti-cu12-12.8.90 nvidia-cuda-nvrtc-cu12-12.8.93 nvidia-cuda-runtime-cu12-12.8.90 nvidia-cudnn-cu12-9.10.2.21 nvidia-cufft-cu12-11.3.3.83 nvidia-cufile-cu12-1.13.1.3 nvidia-curand-cu12-10.3.9.90 nvidia-cusolver-cu12-11.7.3.90 nvidia-cusparse-cu12-12.5.8.93 nvidia-cusparselt-cu12-0.7.1 nvidia-nccl-cu12-2.27.5 nvidia-nvjitlink-cu12-12.8.93 nvidia-nvshmem-cu12-3.4.5 nvidia-nvtx-cu12-12.8.90 sympy-1.14.0 torch-2.10.0 triton-3.6.0 typing-extensions-4.15.0
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default \
    --data_dir data/garden \
    --data_factor 4 \
    --result_dir outputs/difix3d_result \
    --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt \
    --iterations 32000 \
    --save_every 500 \
    --test_every 1000 \
    --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 30, in <module>
    from torchmetrics.image import PeakSignalNoiseRatio, StructuralSimilarityIndexMeasure
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/__init__.py", line 37, in <module>
    from torchmetrics import functional  # noqa: E402
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/functional/__init__.py", line 56, in <module>
    from torchmetrics.functional.image._deprecated import (
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/functional/image/__init__.py", line 14, in <module>
    from torchmetrics.functional.image.arniqa import arniqa
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/functional/image/arniqa.py", line 31, in <module>
    from torchvision import transforms
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchvision/__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchvision/_meta_registrations.py", line 164, in <module>
    def meta_nms(dets, scores, iou_threshold):
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/library.py", line 1073, in register
    use_lib._register_fake(
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/library.py", line 203, in _register_fake
    handle = entry.fake_impl.register(
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/_library/fake_impl.py", line 50, in register
    if torch._C._dispatch_has_kernel_for_dispatch_key(self.qualname, "Meta"):
RuntimeError: operator torchvision::nms does not exist
(difix3d_env) baodinh@asus ~/Difix3D$ conda deactivate
(base) baodinh@asus ~/Difix3D$ conda activate gsplat
(gsplat) baodinh@asus ~/Difix3D$ pip list
Package                   Version         Build
------------------------- --------------- -----
absl-py                   2.3.1
anyio                     4.12.0
attrs                     25.4.0
certifi                   2025.11.12
charset-normalizer        3.4.4
colorlog                  6.10.1
contourpy                 1.3.2
cycler                    0.12.1
docstring_parser          0.17.0
embreex                   2.17.7.post7
exceptiongroup            1.3.1
filelock                  3.20.0
fonttools                 4.61.1
fsspec                    2025.12.0
fused_bilagrid            0.0.0
fused-ssim                1.0.0
grpcio                    1.76.0
gsplat                    1.5.3+pt24cu124
h11                       0.16.0
httpcore                  1.0.9
httpx                     0.28.1
idna                      3.11
ImageIO                   2.37.2
imageio-ffmpeg            0.6.0
jaxtyping                 0.3.4
Jinja2                    3.1.6
joblib                    1.5.3
jsonschema                4.25.1
jsonschema-specifications 2025.9.1
kiwisolver                1.4.9
lightning-utilities       0.15.2
lxml                      6.0.2
manifold3d                3.3.2
mapbox_earcut             2.0.0
Markdown                  3.10
markdown-it-py            4.0.0
MarkupSafe                2.1.5
matplotlib                3.10.8
mdurl                     0.1.2
mpmath                    1.3.0
msgspec                   0.20.0
nerfview                  0.1.2
networkx                  3.4.2
ninja                     1.13.0
nodeenv                   1.10.0
numpy                     1.26.4
nvidia-cublas-cu12        12.4.2.65
nvidia-cuda-cupti-cu12    12.4.99
nvidia-cuda-nvrtc-cu12    12.4.99
nvidia-cuda-runtime-cu12  12.4.99
nvidia-cudnn-cu12         9.1.0.70
nvidia-cufft-cu12         11.2.0.44
nvidia-curand-cu12        10.3.5.119
nvidia-cusolver-cu12      11.6.0.99
nvidia-cusparse-cu12      12.3.0.142
nvidia-nccl-cu12          2.20.5
nvidia-nvjitlink-cu12     12.4.99
nvidia-nvtx-cu12          12.4.99
opencv-python             4.11.0.86
packaging                 25.0
pillow                    12.0.0
pip                       25.3
protobuf                  6.33.2
psutil                    7.1.3
pycollada                 0.9.2
pycolmap                  0.0.1
Pygments                  2.19.2
pyparsing                 3.3.1
python-dateutil           2.9.0.post0
PyYAML                    6.0.3
referencing               0.37.0
requests                  2.32.5
rich                      14.2.0
rpds-py                   0.30.0
rtree                     1.4.1
scikit-learn              1.7.2
scipy                     1.15.3
setuptools                80.9.0
shapely                   2.1.2
six                       1.17.0
splines                   0.3.3
svg.path                  7.0
sympy                     1.14.0
tensorboard               2.20.0
tensorboard-data-server   0.7.2
tensorly                  0.9.0
threadpoolctl             3.6.0
torch                     2.4.1+cu124
torch-fidelity            0.3.0
torchaudio                2.4.1+cu124
torchmetrics              1.8.2
torchvision               0.19.1+cu124
tqdm                      4.67.1
trimesh                   4.10.1
triton                    3.0.0           1
typeguard                 4.4.4
typing_extensions         4.15.0
tyro                      1.0.3
urllib3                   2.6.2
vhacdx                    0.0.10
viser                     1.0.16
wadler_lindig             0.1.7
websockets                15.0.1
Werkzeug                  3.1.4
wheel                     0.45.1
xxhash                    3.6.0
yourdfpy                  0.0.58
(gsplat) baodinh@asus ~/Difix3D$ pip list | grep -E "torch|gsplat|pycolmap|nerfview|fused-ssim|xformers"
fused-ssim                1.0.0
gsplat                    1.5.3+pt24cu124
nerfview                  0.1.2
pycolmap                  0.0.1
torch                     2.4.1+cu124
torch-fidelity            0.3.0
torchaudio                2.4.1+cu124
torchmetrics              1.8.2
torchvision               0.19.1+cu124
(gsplat) baodinh@asus ~/Difix3D$ python -c "import torch; print(f'PyTorch: {torch.__version__}'); print(f'CUDA version: {torch.version.cuda}'); print(f'GPU Available: {torch.cuda.is_available()}'); print(f'Device Name: {torch.cuda.get_device_name(0) if torch.cuda.is_available() else None}')"
PyTorch: 2.4.1+cu124
CUDA version: 12.4
GPU Available: True
Device Name: NVIDIA GeForce RTX 4060 Laptop GPU
(gsplat) baodinh@asus ~/Difix3D$ python --version
Python 3.10.19
(gsplat) baodinh@asus ~/Difix3D$ conda deactivate
(base) baodinh@asus ~/Difix3D$ conda activate difix3d_env
(difix3d_env) baodinh@asus ~/Difix3D$ pip list
Package                   Version
------------------------- ------------
absl-py                   2.3.1
accelerate                1.12.0
annotated-types           0.7.0
anyio                     4.12.1
attrs                     25.4.0
certifi                   2026.1.4
charset-normalizer        3.4.4
click                     8.3.1
colorlog                  6.10.1
contourpy                 1.3.2
cuda-bindings             12.9.4
cuda-pathfinder           1.3.3
cycler                    0.12.1
diffusers                 0.25.1
docstring_parser          0.17.0
einops                    0.8.2
embreex                   2.17.7.post7
exceptiongroup            1.3.1
filelock                  3.20.3
fonttools                 4.61.1
fsspec                    2026.1.0
fused-ssim                1.0.0
gitdb                     4.0.12
GitPython                 3.1.46
grpcio                    1.76.0
gsplat                    1.5.3
h11                       0.16.0
httpcore                  1.0.9
httpx                     0.28.1
huggingface-hub           0.25.1
idna                      3.11
ImageIO                   2.37.2
imageio-ffmpeg            0.6.0
importlib_metadata        8.7.1
jaxtyping                 0.3.6
Jinja2                    3.1.6
joblib                    1.5.3
jsonschema                4.26.0
jsonschema-specifications 2025.9.1
kiwisolver                1.4.9
lightning-utilities       0.15.2
lpips                     0.1.4
lxml                      6.0.2
manifold3d                3.3.2
mapbox_earcut             2.0.0
Markdown                  3.10.1
markdown-it-py            4.0.0
MarkupSafe                3.0.3
matplotlib                3.10.8
mdurl                     0.1.2
mpmath                    1.3.0
msgspec                   0.20.0
nerfview                  0.1.2
networkx                  3.4.2
ninja                     1.13.0
nodeenv                   1.10.0
numpy                     1.26.4
nvidia-cublas-cu12        12.8.4.1
nvidia-cuda-cupti-cu12    12.8.90
nvidia-cuda-nvrtc-cu12    12.8.93
nvidia-cuda-runtime-cu12  12.8.90
nvidia-cudnn-cu12         9.10.2.21
nvidia-cufft-cu12         11.3.3.83
nvidia-cufile-cu12        1.13.1.3
nvidia-curand-cu12        10.3.9.90
nvidia-cusolver-cu12      11.7.3.90
nvidia-cusparse-cu12      12.5.8.93
nvidia-cusparselt-cu12    0.7.1
nvidia-nccl-cu12          2.27.5
nvidia-nvjitlink-cu12     12.8.93
nvidia-nvshmem-cu12       3.4.5
nvidia-nvtx-cu12          12.8.90
opencv-python             4.11.0.86
packaging                 26.0
peft                      0.9.0
pillow                    12.0.0
pip                       25.3
platformdirs              4.5.1
protobuf                  6.33.4
psutil                    7.2.1
pycollada                 0.9.3
pycolmap                  0.0.1
pydantic                  2.12.5
pydantic_core             2.41.5
Pygments                  2.19.2
pyparsing                 3.3.2
python-dateutil           2.9.0.post0
PyYAML                    6.0.3
referencing               0.37.0
regex                     2026.1.15
requests                  2.32.5
rich                      14.3.1
rpds-py                   0.30.0
rtree                     1.4.1
safetensors               0.7.0
scikit-learn              1.7.2
scipy                     1.15.3
sentry-sdk                2.50.0
setuptools                80.10.1
shapely                   2.1.2
six                       1.17.0
smmap                     5.0.2
splines                   0.3.3
svg.path                  7.0
sympy                     1.14.0
tensorboard               2.20.0
tensorboard-data-server   0.7.2
tensorly                  0.9.0
threadpoolctl             3.6.0
tokenizers                0.15.2
torch                     2.10.0
torch-fidelity            0.3.0
torchaudio                2.5.1+cu121
torchmetrics              1.8.2
torchvision               0.20.1+cu121
tqdm                      4.67.1
transformers              4.38.0
trimesh                   4.11.1
triton                    3.6.0
typeguard                 4.4.4
typing_extensions         4.15.0
typing-inspection         0.4.2
tyro                      1.0.5
urllib3                   2.6.3
vhacdx                    0.0.10
viser                     1.0.21
wadler_lindig             0.1.7
wandb                     0.24.0
websockets                15.0.1
Werkzeug                  3.1.5
wheel                     0.46.3
xformers                  0.0.29.post1
xxhash                    3.6.0
yourdfpy                  0.0.60
zipp                      3.23.0
zstandard                 0.25.0
(difix3d_env) baodinh@asus ~/Difix3D$ pip list | grep -E "torch|gsplat|pycolmap|nerfview|fused-ssim|xformers"
fused-ssim                1.0.0
gsplat                    1.5.3
nerfview                  0.1.2
pycolmap                  0.0.1
torch                     2.10.0
torch-fidelity            0.3.0
torchaudio                2.5.1+cu121
torchmetrics              1.8.2
torchvision               0.20.1+cu121
xformers                  0.0.29.post1
(difix3d_env) baodinh@asus ~/Difix3D$ python -c "import torch; print(f'PyTorch: {torch.__version__}'); print(f'CUDA version: {torch.version.cuda}'); print(f'GPU Available: {torch.cuda.is_available()}'); print(f'Device Name: {torch.cuda.get_device_name(0) if torch.cuda.is_available() else None}')"
PyTorch: 2.10.0+cu128
CUDA version: 12.8
GPU Available: True
Device Name: NVIDIA GeForce RTX 4060 Laptop GPU
(difix3d_env) baodinh@asus ~/Difix3D$ python --version
Python 3.10.19
(difix3d_env) baodinh@asus ~/Difix3D$ # Đảm bảo đang ở trong difix3d_env
pip uninstall torch torchvision torchaudio xformers gsplat fused-ssim -y
Found existing installation: torch 2.10.0
Uninstalling torch-2.10.0:
  Successfully uninstalled torch-2.10.0
Found existing installation: torchvision 0.20.1+cu121
Uninstalling torchvision-0.20.1+cu121:
  Successfully uninstalled torchvision-0.20.1+cu121
Found existing installation: torchaudio 2.5.1+cu121
Uninstalling torchaudio-2.5.1+cu121:
  Successfully uninstalled torchaudio-2.5.1+cu121
Found existing installation: xformers 0.0.29.post1
Uninstalling xformers-0.0.29.post1:
  Successfully uninstalled xformers-0.0.29.post1
Found existing installation: gsplat 1.5.3
Uninstalling gsplat-1.5.3:
  Successfully uninstalled gsplat-1.5.3
Found existing installation: fused-ssim 1.0.0
Uninstalling fused-ssim-1.0.0:
  Successfully uninstalled fused-ssim-1.0.0
(difix3d_env) baodinh@asus ~/Difix3D$ pip install torch==2.4.1 torchvision==0.19.1 torchaudio==2.4.1 --index-url https://download.pytorch.org/whl/cu124
Looking in indexes: https://download.pytorch.org/whl/cu124
Collecting torch==2.4.1
  Using cached https://download.pytorch.org/whl/cu124/torch-2.4.1%2Bcu124-cp310-cp310-linux_x86_64.whl (797.2 MB)
Collecting torchvision==0.19.1
  Using cached https://download.pytorch.org/whl/cu124/torchvision-0.19.1%2Bcu124-cp310-cp310-linux_x86_64.whl (7.1 MB)
Collecting torchaudio==2.4.1
  Using cached https://download.pytorch.org/whl/cu124/torchaudio-2.4.1%2Bcu124-cp310-cp310-linux_x86_64.whl (3.4 MB)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.20.3)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (4.15.0)
Requirement already satisfied: sympy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (1.14.0)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.1.6)
Requirement already satisfied: fsspec in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (2026.1.0)
Collecting nvidia-cuda-nvrtc-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cuda_nvrtc_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (24.7 MB)
Collecting nvidia-cuda-runtime-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cuda_runtime_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (883 kB)
Collecting nvidia-cuda-cupti-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cuda_cupti_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (13.8 MB)
Collecting nvidia-cudnn-cu12==9.1.0.70 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl (664.8 MB)
Collecting nvidia-cublas-cu12==12.4.2.65 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cublas_cu12-12.4.2.65-py3-none-manylinux2014_x86_64.whl (363.0 MB)
Collecting nvidia-cufft-cu12==11.2.0.44 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cufft_cu12-11.2.0.44-py3-none-manylinux2014_x86_64.whl (211.5 MB)
Collecting nvidia-curand-cu12==10.3.5.119 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_curand_cu12-10.3.5.119-py3-none-manylinux2014_x86_64.whl (56.3 MB)
Collecting nvidia-cusolver-cu12==11.6.0.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cusolver_cu12-11.6.0.99-py3-none-manylinux2014_x86_64.whl (128.4 MB)
Collecting nvidia-cusparse-cu12==12.3.0.142 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cusparse_cu12-12.3.0.142-py3-none-manylinux2014_x86_64.whl (207.5 MB)
Collecting nvidia-nccl-cu12==2.20.5 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl (176.2 MB)
Collecting nvidia-nvtx-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_nvtx_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (99 kB)
Collecting nvidia-nvjitlink-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_nvjitlink_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (21.1 MB)
Collecting triton==3.0.0 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/triton-3.0.0-1-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (209.4 MB)
Requirement already satisfied: numpy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchvision==0.19.1) (1.26.4)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchvision==0.19.1) (12.0.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jinja2->torch==2.4.1) (3.0.3)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy->torch==2.4.1) (1.3.0)
Installing collected packages: triton, nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, nvidia-cusparse-cu12, nvidia-cudnn-cu12, nvidia-cusolver-cu12, torch, torchvision, torchaudio
  Attempting uninstall: triton
    Found existing installation: triton 3.6.0
    Uninstalling triton-3.6.0:
      Successfully uninstalled triton-3.6.0
  Attempting uninstall: nvidia-nvtx-cu12
    Found existing installation: nvidia-nvtx-cu12 12.8.90
    Uninstalling nvidia-nvtx-cu12-12.8.90:
      Successfully uninstalled nvidia-nvtx-cu12-12.8.90
  Attempting uninstall: nvidia-nvjitlink-cu12
    Found existing installation: nvidia-nvjitlink-cu12 12.8.93
    Uninstalling nvidia-nvjitlink-cu12-12.8.93:
      Successfully uninstalled nvidia-nvjitlink-cu12-12.8.93
  Attempting uninstall: nvidia-nccl-cu12
    Found existing installation: nvidia-nccl-cu12 2.27.5
    Uninstalling nvidia-nccl-cu12-2.27.5:
      Successfully uninstalled nvidia-nccl-cu12-2.27.5
  Attempting uninstall: nvidia-curand-cu12
    Found existing installation: nvidia-curand-cu12 10.3.9.90
    Uninstalling nvidia-curand-cu12-10.3.9.90:
      Successfully uninstalled nvidia-curand-cu12-10.3.9.90
  Attempting uninstall: nvidia-cufft-cu12
    Found existing installation: nvidia-cufft-cu12 11.3.3.83
    Uninstalling nvidia-cufft-cu12-11.3.3.83:
      Successfully uninstalled nvidia-cufft-cu12-11.3.3.83
  Attempting uninstall: nvidia-cuda-runtime-cu12
    Found existing installation: nvidia-cuda-runtime-cu12 12.8.90
    Uninstalling nvidia-cuda-runtime-cu12-12.8.90:
      Successfully uninstalled nvidia-cuda-runtime-cu12-12.8.90
  Attempting uninstall: nvidia-cuda-nvrtc-cu12
    Found existing installation: nvidia-cuda-nvrtc-cu12 12.8.93
    Uninstalling nvidia-cuda-nvrtc-cu12-12.8.93:
      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.8.93
  Attempting uninstall: nvidia-cuda-cupti-cu12
    Found existing installation: nvidia-cuda-cupti-cu12 12.8.90
    Uninstalling nvidia-cuda-cupti-cu12-12.8.90:
      Successfully uninstalled nvidia-cuda-cupti-cu12-12.8.90
  Attempting uninstall: nvidia-cublas-cu12
    Found existing installation: nvidia-cublas-cu12 12.8.4.1
    Uninstalling nvidia-cublas-cu12-12.8.4.1:
      Successfully uninstalled nvidia-cublas-cu12-12.8.4.1
  Attempting uninstall: nvidia-cusparse-cu12
    Found existing installation: nvidia-cusparse-cu12 12.5.8.93
    Uninstalling nvidia-cusparse-cu12-12.5.8.93:
      Successfully uninstalled nvidia-cusparse-cu12-12.5.8.93
  Attempting uninstall: nvidia-cudnn-cu12
    Found existing installation: nvidia-cudnn-cu12 9.10.2.21
    Uninstalling nvidia-cudnn-cu12-9.10.2.21:
      Successfully uninstalled nvidia-cudnn-cu12-9.10.2.21
  Attempting uninstall: nvidia-cusolver-cu12
    Found existing installation: nvidia-cusolver-cu12 11.7.3.90
    Uninstalling nvidia-cusolver-cu12-11.7.3.90:
      Successfully uninstalled nvidia-cusolver-cu12-11.7.3.90
Successfully installed nvidia-cublas-cu12-12.4.2.65 nvidia-cuda-cupti-cu12-12.4.99 nvidia-cuda-nvrtc-cu12-12.4.99 nvidia-cuda-runtime-cu12-12.4.99 nvidia-cudnn-cu12-9.1.0.70 nvidia-cufft-cu12-11.2.0.44 nvidia-curand-cu12-10.3.5.119 nvidia-cusolver-cu12-11.6.0.99 nvidia-cusparse-cu12-12.3.0.142 nvidia-nccl-cu12-2.20.5 nvidia-nvjitlink-cu12-12.4.99 nvidia-nvtx-cu12-12.4.99 torch-2.4.1+cu124 torchaudio-2.4.1+cu124 torchvision-0.19.1+cu124 triton-3.0.0
(difix3d_env) baodinh@asus ~/Difix3D$ # 1. Cài gsplat (Bây giờ nó sẽ tự tìm bản +pt24cu124 giống bên kia)
pip install gsplat==1.5.3

# 2. Cài xformers tương thích với Torch 2.4.1 (Quan trọng cho Diffusion nhanh)
pip install xformers==0.0.28

# 3. Biên dịch lại fused-ssim (Bắt buộc)
pip install git+https://github.com/rahul-goel/fused-ssim --force-reinstall --no-cache-dir --no-build-isolation
Collecting gsplat==1.5.3
  Using cached gsplat-1.5.3-py3-none-any.whl.metadata (1.1 kB)
Requirement already satisfied: ninja in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat==1.5.3) (1.13.0)
Requirement already satisfied: numpy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat==1.5.3) (1.26.4)
Requirement already satisfied: jaxtyping in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat==1.5.3) (0.3.6)
Requirement already satisfied: rich>=12 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat==1.5.3) (14.3.1)
Requirement already satisfied: torch in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat==1.5.3) (2.4.1+cu124)
Requirement already satisfied: markdown-it-py>=2.2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from rich>=12->gsplat==1.5.3) (4.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from rich>=12->gsplat==1.5.3) (2.19.2)
Requirement already satisfied: mdurl~=0.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from markdown-it-py>=2.2.0->rich>=12->gsplat==1.5.3) (0.1.2)
Requirement already satisfied: wadler-lindig>=0.1.3 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jaxtyping->gsplat==1.5.3) (0.1.7)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (3.20.3)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (4.15.0)
Requirement already satisfied: sympy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (1.14.0)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (3.1.6)
Requirement already satisfied: fsspec in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (2026.1.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.99)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.99)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.99)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.4.2.65 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.2.65)
Requirement already satisfied: nvidia-cufft-cu12==11.2.0.44 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (11.2.0.44)
Requirement already satisfied: nvidia-curand-cu12==10.3.5.119 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (10.3.5.119)
Requirement already satisfied: nvidia-cusolver-cu12==11.6.0.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (11.6.0.99)
Requirement already satisfied: nvidia-cusparse-cu12==12.3.0.142 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.3.0.142)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (2.20.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.99)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.99)
Requirement already satisfied: triton==3.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (3.0.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jinja2->torch->gsplat==1.5.3) (3.0.3)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy->torch->gsplat==1.5.3) (1.3.0)
Using cached gsplat-1.5.3-py3-none-any.whl (6.5 MB)
Installing collected packages: gsplat
Successfully installed gsplat-1.5.3
Collecting xformers==0.0.28
  Downloading xformers-0.0.28-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (1.0 kB)
Requirement already satisfied: numpy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from xformers==0.0.28) (1.26.4)
Requirement already satisfied: torch==2.4.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from xformers==0.0.28) (2.4.1+cu124)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (3.20.3)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (4.15.0)
Requirement already satisfied: sympy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (1.14.0)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (3.1.6)
Requirement already satisfied: fsspec in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (2026.1.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (12.4.99)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (12.4.99)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (12.4.99)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.4.2.65 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (12.4.2.65)
Requirement already satisfied: nvidia-cufft-cu12==11.2.0.44 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (11.2.0.44)
Requirement already satisfied: nvidia-curand-cu12==10.3.5.119 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (10.3.5.119)
Requirement already satisfied: nvidia-cusolver-cu12==11.6.0.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (11.6.0.99)
Requirement already satisfied: nvidia-cusparse-cu12==12.3.0.142 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (12.3.0.142)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (2.20.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (12.4.99)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (12.4.99)
Requirement already satisfied: triton==3.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1->xformers==0.0.28) (3.0.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jinja2->torch==2.4.1->xformers==0.0.28) (3.0.3)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy->torch==2.4.1->xformers==0.0.28) (1.3.0)
Downloading xformers-0.0.28-cp310-cp310-manylinux_2_28_x86_64.whl (16.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16.7/16.7 MB 14.0 MB/s  0:00:01
Installing collected packages: xformers
Successfully installed xformers-0.0.28
Collecting git+https://github.com/rahul-goel/fused-ssim
  Cloning https://github.com/rahul-goel/fused-ssim to /tmp/pip-req-build-qestsk3n
  Running command git clone --filter=blob:none --quiet https://github.com/rahul-goel/fused-ssim /tmp/pip-req-build-qestsk3n
  Resolved https://github.com/rahul-goel/fused-ssim to commit 0ac916a05f48f8e477dc8ce1651a346b65ce2072
  Preparing metadata (pyproject.toml) ... done
Collecting torch>=2.0.0 (from fused-ssim==1.0.0)
  Downloading torch-2.10.0-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (31 kB)
Collecting filelock (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading filelock-3.20.3-py3-none-any.whl.metadata (2.1 kB)
Collecting typing-extensions>=4.10.0 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Collecting sympy>=1.13.3 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading sympy-1.14.0-py3-none-any.whl.metadata (12 kB)
Collecting networkx>=2.5.1 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading networkx-3.4.2-py3-none-any.whl.metadata (6.3 kB)
Collecting jinja2 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)
Collecting fsspec>=0.8.5 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading fsspec-2026.1.0-py3-none-any.whl.metadata (10 kB)
Collecting cuda-bindings==12.9.4 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading cuda_bindings-12.9.4-cp310-cp310-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl.metadata (2.6 kB)
Collecting nvidia-cuda-nvrtc-cu12==12.8.93 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cuda_nvrtc_cu12-12.8.93-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cuda-runtime-cu12==12.8.90 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cuda_runtime_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cuda-cupti-cu12==12.8.90 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cuda_cupti_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cudnn-cu12==9.10.2.21 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cudnn_cu12-9.10.2.21-py3-none-manylinux_2_27_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-cublas-cu12==12.8.4.1 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cublas_cu12-12.8.4.1-py3-none-manylinux_2_27_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cufft-cu12==11.3.3.83 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cufft_cu12-11.3.3.83-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-curand-cu12==10.3.9.90 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_curand_cu12-10.3.9.90-py3-none-manylinux_2_27_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cusolver-cu12==11.7.3.90 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cusolver_cu12-11.7.3.90-py3-none-manylinux_2_27_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-cusparse-cu12==12.5.8.93 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cusparse_cu12-12.5.8.93-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-cusparselt-cu12==0.7.1 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cusparselt_cu12-0.7.1-py3-none-manylinux2014_x86_64.whl.metadata (7.0 kB)
Collecting nvidia-nccl-cu12==2.27.5 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_nccl_cu12-2.27.5-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (2.0 kB)
Collecting nvidia-nvshmem-cu12==3.4.5 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_nvshmem_cu12-3.4.5-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (2.1 kB)
Collecting nvidia-nvtx-cu12==12.8.90 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_nvtx_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-nvjitlink-cu12==12.8.93 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_nvjitlink_cu12-12.8.93-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-cufile-cu12==1.13.1.3 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading nvidia_cufile_cu12-1.13.1.3-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.7 kB)
Collecting triton==3.6.0 (from torch>=2.0.0->fused-ssim==1.0.0)
  Downloading triton-3.6.0-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (1.7 kB)
Collecting cuda-pathfinder~=1.1 (from cuda-bindings==12.9.4->torch>=2.0.0->fused-ssim==1.0.0)
  Downloading cuda_pathfinder-1.3.3-py3-none-any.whl.metadata (1.9 kB)
Collecting mpmath<1.4,>=1.1.0 (from sympy>=1.13.3->torch>=2.0.0->fused-ssim==1.0.0)
  Downloading mpmath-1.3.0-py3-none-any.whl.metadata (8.6 kB)
Collecting MarkupSafe>=2.0 (from jinja2->torch>=2.0.0->fused-ssim==1.0.0)
  Downloading markupsafe-3.0.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (2.7 kB)
Downloading torch-2.10.0-cp310-cp310-manylinux_2_28_x86_64.whl (915.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 915.6/915.6 MB 15.4 MB/s  0:01:00
Downloading cuda_bindings-12.9.4-cp310-cp310-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl (12.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.1/12.1 MB 14.9 MB/s  0:00:00
Downloading nvidia_cublas_cu12-12.8.4.1-py3-none-manylinux_2_27_x86_64.whl (594.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 594.3/594.3 MB 14.1 MB/s  0:00:40
Downloading nvidia_cuda_cupti_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (10.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.2/10.2 MB 14.1 MB/s  0:00:00
Downloading nvidia_cuda_nvrtc_cu12-12.8.93-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl (88.0 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 88.0/88.0 MB 13.7 MB/s  0:00:06
Downloading nvidia_cuda_runtime_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (954 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 954.8/954.8 kB 8.9 MB/s  0:00:00
Downloading nvidia_cudnn_cu12-9.10.2.21-py3-none-manylinux_2_27_x86_64.whl (706.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 706.8/706.8 MB 15.0 MB/s  0:00:47
Downloading nvidia_cufft_cu12-11.3.3.83-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (193.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 193.1/193.1 MB 14.9 MB/s  0:00:12
Downloading nvidia_cufile_cu12-1.13.1.3-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (1.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 10.8 MB/s  0:00:00
Downloading nvidia_curand_cu12-10.3.9.90-py3-none-manylinux_2_27_x86_64.whl (63.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 63.6/63.6 MB 14.6 MB/s  0:00:04
Downloading nvidia_cusolver_cu12-11.7.3.90-py3-none-manylinux_2_27_x86_64.whl (267.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 267.5/267.5 MB 15.3 MB/s  0:00:17
Downloading nvidia_cusparse_cu12-12.5.8.93-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (288.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 288.2/288.2 MB 15.1 MB/s  0:00:19
Downloading nvidia_cusparselt_cu12-0.7.1-py3-none-manylinux2014_x86_64.whl (287.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 287.2/287.2 MB 15.1 MB/s  0:00:18
Downloading nvidia_nccl_cu12-2.27.5-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (322.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 322.3/322.3 MB 14.1 MB/s  0:00:22
Downloading nvidia_nvjitlink_cu12-12.8.93-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl (39.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 39.3/39.3 MB 14.8 MB/s  0:00:02
Downloading nvidia_nvshmem_cu12-3.4.5-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (139.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 139.1/139.1 MB 14.4 MB/s  0:00:09
Downloading nvidia_nvtx_cu12-12.8.90-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (89 kB)
Downloading triton-3.6.0-cp310-cp310-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (188.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 188.1/188.1 MB 15.2 MB/s  0:00:12
Downloading cuda_pathfinder-1.3.3-py3-none-any.whl (27 kB)
Downloading fsspec-2026.1.0-py3-none-any.whl (201 kB)
Downloading networkx-3.4.2-py3-none-any.whl (1.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.7/1.7 MB 11.4 MB/s  0:00:00
Downloading sympy-1.14.0-py3-none-any.whl (6.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.3/6.3 MB 12.1 MB/s  0:00:00
Downloading mpmath-1.3.0-py3-none-any.whl (536 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 536.2/536.2 kB 21.6 MB/s  0:00:00
Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
Downloading filelock-3.20.3-py3-none-any.whl (16 kB)
Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)
Downloading markupsafe-3.0.3-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (20 kB)
Building wheels for collected packages: fused-ssim
  Building wheel for fused-ssim (pyproject.toml) ... done
  Created wheel for fused-ssim: filename=fused_ssim-1.0.0-cp310-cp310-linux_x86_64.whl size=142078 sha256=529342fc4661f52b4e83b02387ba8ba414497596f49a5f4fb769311f41e28f1c
  Stored in directory: /tmp/pip-ephem-wheel-cache-ipce5fs8/wheels/ab/6e/5f/1691340c88bd2bb55b7c5905183d398dbc079b5e4e01adf9ee
Successfully built fused-ssim
Installing collected packages: nvidia-cusparselt-cu12, mpmath, typing-extensions, triton, sympy, nvidia-nvtx-cu12, nvidia-nvshmem-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufile-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, networkx, MarkupSafe, fsspec, filelock, cuda-pathfinder, nvidia-cusparse-cu12, nvidia-cufft-cu12, nvidia-cudnn-cu12, jinja2, cuda-bindings, nvidia-cusolver-cu12, torch, fused-ssim
  Attempting uninstall: nvidia-cusparselt-cu12
    Found existing installation: nvidia-cusparselt-cu12 0.7.1
    Uninstalling nvidia-cusparselt-cu12-0.7.1:
      Successfully uninstalled nvidia-cusparselt-cu12-0.7.1
  Attempting uninstall: mpmath
    Found existing installation: mpmath 1.3.0
    Uninstalling mpmath-1.3.0:
      Successfully uninstalled mpmath-1.3.0
  Attempting uninstall: typing-extensions
    Found existing installation: typing_extensions 4.15.0
    Uninstalling typing_extensions-4.15.0:
      Successfully uninstalled typing_extensions-4.15.0
  Attempting uninstall: triton
    Found existing installation: triton 3.0.0
    Uninstalling triton-3.0.0:
      Successfully uninstalled triton-3.0.0
  Attempting uninstall: sympy
    Found existing installation: sympy 1.14.0
    Uninstalling sympy-1.14.0:
      Successfully uninstalled sympy-1.14.0
  Attempting uninstall: nvidia-nvtx-cu12
    Found existing installation: nvidia-nvtx-cu12 12.4.99
    Uninstalling nvidia-nvtx-cu12-12.4.99:
      Successfully uninstalled nvidia-nvtx-cu12-12.4.99
  Attempting uninstall: nvidia-nvshmem-cu12
    Found existing installation: nvidia-nvshmem-cu12 3.4.5
    Uninstalling nvidia-nvshmem-cu12-3.4.5:
      Successfully uninstalled nvidia-nvshmem-cu12-3.4.5
  Attempting uninstall: nvidia-nvjitlink-cu12
    Found existing installation: nvidia-nvjitlink-cu12 12.4.99
    Uninstalling nvidia-nvjitlink-cu12-12.4.99:
      Successfully uninstalled nvidia-nvjitlink-cu12-12.4.99
  Attempting uninstall: nvidia-nccl-cu12
    Found existing installation: nvidia-nccl-cu12 2.20.5
    Uninstalling nvidia-nccl-cu12-2.20.5:
      Successfully uninstalled nvidia-nccl-cu12-2.20.5
  Attempting uninstall: nvidia-curand-cu12
    Found existing installation: nvidia-curand-cu12 10.3.5.119
    Uninstalling nvidia-curand-cu12-10.3.5.119:
      Successfully uninstalled nvidia-curand-cu12-10.3.5.119
  Attempting uninstall: nvidia-cufile-cu12
    Found existing installation: nvidia-cufile-cu12 1.13.1.3
    Uninstalling nvidia-cufile-cu12-1.13.1.3:
      Successfully uninstalled nvidia-cufile-cu12-1.13.1.3
  Attempting uninstall: nvidia-cuda-runtime-cu12
    Found existing installation: nvidia-cuda-runtime-cu12 12.4.99
    Uninstalling nvidia-cuda-runtime-cu12-12.4.99:
      Successfully uninstalled nvidia-cuda-runtime-cu12-12.4.99
  Attempting uninstall: nvidia-cuda-nvrtc-cu12
    Found existing installation: nvidia-cuda-nvrtc-cu12 12.4.99
    Uninstalling nvidia-cuda-nvrtc-cu12-12.4.99:
      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.4.99
  Attempting uninstall: nvidia-cuda-cupti-cu12
    Found existing installation: nvidia-cuda-cupti-cu12 12.4.99
    Uninstalling nvidia-cuda-cupti-cu12-12.4.99:
      Successfully uninstalled nvidia-cuda-cupti-cu12-12.4.99
  Attempting uninstall: nvidia-cublas-cu12
    Found existing installation: nvidia-cublas-cu12 12.4.2.65
    Uninstalling nvidia-cublas-cu12-12.4.2.65:
      Successfully uninstalled nvidia-cublas-cu12-12.4.2.65
  Attempting uninstall: networkx
    Found existing installation: networkx 3.4.2
    Uninstalling networkx-3.4.2:
      Successfully uninstalled networkx-3.4.2
  Attempting uninstall: MarkupSafe
    Found existing installation: MarkupSafe 3.0.3
    Uninstalling MarkupSafe-3.0.3:
      Successfully uninstalled MarkupSafe-3.0.3
  Attempting uninstall: fsspec
    Found existing installation: fsspec 2026.1.0
    Uninstalling fsspec-2026.1.0:
      Successfully uninstalled fsspec-2026.1.0
  Attempting uninstall: filelock
    Found existing installation: filelock 3.20.3
    Uninstalling filelock-3.20.3:
      Successfully uninstalled filelock-3.20.3
  Attempting uninstall: cuda-pathfinder
    Found existing installation: cuda-pathfinder 1.3.3
    Uninstalling cuda-pathfinder-1.3.3:
      Successfully uninstalled cuda-pathfinder-1.3.3
  Attempting uninstall: nvidia-cusparse-cu12
    Found existing installation: nvidia-cusparse-cu12 12.3.0.142
    Uninstalling nvidia-cusparse-cu12-12.3.0.142:
      Successfully uninstalled nvidia-cusparse-cu12-12.3.0.142
  Attempting uninstall: nvidia-cufft-cu12
    Found existing installation: nvidia-cufft-cu12 11.2.0.44
    Uninstalling nvidia-cufft-cu12-11.2.0.44:
      Successfully uninstalled nvidia-cufft-cu12-11.2.0.44
  Attempting uninstall: nvidia-cudnn-cu12
    Found existing installation: nvidia-cudnn-cu12 9.1.0.70
    Uninstalling nvidia-cudnn-cu12-9.1.0.70:
      Successfully uninstalled nvidia-cudnn-cu12-9.1.0.70
  Attempting uninstall: jinja2
    Found existing installation: Jinja2 3.1.6
    Uninstalling Jinja2-3.1.6:
      Successfully uninstalled Jinja2-3.1.6
  Attempting uninstall: cuda-bindings
    Found existing installation: cuda-bindings 12.9.4
    Uninstalling cuda-bindings-12.9.4:
      Successfully uninstalled cuda-bindings-12.9.4
  Attempting uninstall: nvidia-cusolver-cu12
    Found existing installation: nvidia-cusolver-cu12 11.6.0.99
    Uninstalling nvidia-cusolver-cu12-11.6.0.99:
      Successfully uninstalled nvidia-cusolver-cu12-11.6.0.99
  Attempting uninstall: torch
    Found existing installation: torch 2.4.1+cu124
    Uninstalling torch-2.4.1+cu124:
      Successfully uninstalled torch-2.4.1+cu124
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
torchaudio 2.4.1+cu124 requires torch==2.4.1, but you have torch 2.10.0 which is incompatible.
torchvision 0.19.1+cu124 requires torch==2.4.1, but you have torch 2.10.0 which is incompatible.
xformers 0.0.28 requires torch==2.4.1, but you have torch 2.10.0 which is incompatible.
Successfully installed MarkupSafe-3.0.3 cuda-bindings-12.9.4 cuda-pathfinder-1.3.3 filelock-3.20.3 fsspec-2026.1.0 fused-ssim-1.0.0 jinja2-3.1.6 mpmath-1.3.0 networkx-3.4.2 nvidia-cublas-cu12-12.8.4.1 nvidia-cuda-cupti-cu12-12.8.90 nvidia-cuda-nvrtc-cu12-12.8.93 nvidia-cuda-runtime-cu12-12.8.90 nvidia-cudnn-cu12-9.10.2.21 nvidia-cufft-cu12-11.3.3.83 nvidia-cufile-cu12-1.13.1.3 nvidia-curand-cu12-10.3.9.90 nvidia-cusolver-cu12-11.7.3.90 nvidia-cusparse-cu12-12.5.8.93 nvidia-cusparselt-cu12-0.7.1 nvidia-nccl-cu12-2.27.5 nvidia-nvjitlink-cu12-12.8.93 nvidia-nvshmem-cu12-3.4.5 nvidia-nvtx-cu12-12.8.90 sympy-1.14.0 torch-2.10.0 triton-3.6.0 typing-extensions-4.15.0
(difix3d_env) baodinh@asus ~/Difix3D$ ^C
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default     --data_dir data/garden     --data_factor 4     --result_dir outputs/difix3d_result     --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt     --iterations 32000     --save_every 500     --test_every 1000     --disable_viewer
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 30, in <module>
    from torchmetrics.image import PeakSignalNoiseRatio, StructuralSimilarityIndexMeasure
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/__init__.py", line 37, in <module>
    from torchmetrics import functional  # noqa: E402
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/functional/__init__.py", line 56, in <module>
    from torchmetrics.functional.image._deprecated import (
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/functional/image/__init__.py", line 14, in <module>
    from torchmetrics.functional.image.arniqa import arniqa
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/functional/image/arniqa.py", line 31, in <module>
    from torchvision import transforms
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchvision/__init__.py", line 10, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils  # usort:skip
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchvision/_meta_registrations.py", line 164, in <module>
    def meta_nms(dets, scores, iou_threshold):
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/library.py", line 1073, in register
    use_lib._register_fake(
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/library.py", line 203, in _register_fake
    handle = entry.fake_impl.register(
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/_library/fake_impl.py", line 50, in register
    if torch._C._dispatch_has_kernel_for_dispatch_key(self.qualname, "Meta"):
RuntimeError: operator torchvision::nms does not exist
(difix3d_env) baodinh@asus ~/Difix3D$ pip uninstall torch torchvision torchaudio xformers fused-ssim -y
Found existing installation: torch 2.10.0
Uninstalling torch-2.10.0:
  Successfully uninstalled torch-2.10.0
Found existing installation: torchvision 0.19.1+cu124
Uninstalling torchvision-0.19.1+cu124:
  Successfully uninstalled torchvision-0.19.1+cu124
Found existing installation: torchaudio 2.4.1+cu124
Uninstalling torchaudio-2.4.1+cu124:
  Successfully uninstalled torchaudio-2.4.1+cu124
Found existing installation: xformers 0.0.28
Uninstalling xformers-0.0.28:
  Successfully uninstalled xformers-0.0.28
Found existing installation: fused-ssim 1.0.0
Uninstalling fused-ssim-1.0.0:
  Successfully uninstalled fused-ssim-1.0.0
(difix3d_env) baodinh@asus ~/Difix3D$ pip install torch==2.4.1 torchvision==0.19.1 torchaudio==2.4.1 xformers==0.0.28 --index-url https://download.pytorch.org/whl/cu124
Looking in indexes: https://download.pytorch.org/whl/cu124
Collecting torch==2.4.1
  Using cached https://download.pytorch.org/whl/cu124/torch-2.4.1%2Bcu124-cp310-cp310-linux_x86_64.whl (797.2 MB)
Collecting torchvision==0.19.1
  Using cached https://download.pytorch.org/whl/cu124/torchvision-0.19.1%2Bcu124-cp310-cp310-linux_x86_64.whl (7.1 MB)
Collecting torchaudio==2.4.1
  Using cached https://download.pytorch.org/whl/cu124/torchaudio-2.4.1%2Bcu124-cp310-cp310-linux_x86_64.whl (3.4 MB)
ERROR: Could not find a version that satisfies the requirement xformers==0.0.28 (from versions: 0.0.28.post1, 0.0.28.post2, 0.0.28.post3, 0.0.29, 0.0.29.post1, 0.0.29.post2, 0.0.29.post3)
ERROR: No matching distribution found for xformers==0.0.28
(difix3d_env) baodinh@asus ~/Difix3D$ pip install git+https://github.com/rahul-goel/fused-ssim --no-deps --force-reinstall
Collecting git+https://github.com/rahul-goel/fused-ssim
  Cloning https://github.com/rahul-goel/fused-ssim to /tmp/pip-req-build-ibprsqqh
  Running command git clone --filter=blob:none --quiet https://github.com/rahul-goel/fused-ssim /tmp/pip-req-build-ibprsqqh
  Resolved https://github.com/rahul-goel/fused-ssim to commit 0ac916a05f48f8e477dc8ce1651a346b65ce2072
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Building wheels for collected packages: fused-ssim
  Building wheel for fused-ssim (pyproject.toml) ... done
  Created wheel for fused-ssim: filename=fused_ssim-1.0.0-cp310-cp310-linux_x86_64.whl size=158289 sha256=31cb7aa1263649f74a0013544975a9e7b29054281953add62147f6530b9003f9
  Stored in directory: /tmp/pip-ephem-wheel-cache-c9sicu_v/wheels/ab/6e/5f/1691340c88bd2bb55b7c5905183d398dbc079b5e4e01adf9ee
Successfully built fused-ssim
Installing collected packages: fused-ssim
Successfully installed fused-ssim-1.0.0
(difix3d_env) baodinh@asus ~/Difix3D$ pip install torch==2.4.1 torchvision==0.19.1 torchaudio==2.4.1 --index-url https://download.pytorch.org/whl/cu124
Looking in indexes: https://download.pytorch.org/whl/cu124
Collecting torch==2.4.1
  Using cached https://download.pytorch.org/whl/cu124/torch-2.4.1%2Bcu124-cp310-cp310-linux_x86_64.whl (797.2 MB)
Collecting torchvision==0.19.1
  Using cached https://download.pytorch.org/whl/cu124/torchvision-0.19.1%2Bcu124-cp310-cp310-linux_x86_64.whl (7.1 MB)
Collecting torchaudio==2.4.1
  Using cached https://download.pytorch.org/whl/cu124/torchaudio-2.4.1%2Bcu124-cp310-cp310-linux_x86_64.whl (3.4 MB)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.20.3)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (4.15.0)
Requirement already satisfied: sympy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (1.14.0)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.1.6)
Requirement already satisfied: fsspec in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (2026.1.0)
Collecting nvidia-cuda-nvrtc-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cuda_nvrtc_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (24.7 MB)
Collecting nvidia-cuda-runtime-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cuda_runtime_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (883 kB)
Collecting nvidia-cuda-cupti-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cuda_cupti_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (13.8 MB)
Collecting nvidia-cudnn-cu12==9.1.0.70 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl (664.8 MB)
Collecting nvidia-cublas-cu12==12.4.2.65 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cublas_cu12-12.4.2.65-py3-none-manylinux2014_x86_64.whl (363.0 MB)
Collecting nvidia-cufft-cu12==11.2.0.44 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cufft_cu12-11.2.0.44-py3-none-manylinux2014_x86_64.whl (211.5 MB)
Collecting nvidia-curand-cu12==10.3.5.119 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_curand_cu12-10.3.5.119-py3-none-manylinux2014_x86_64.whl (56.3 MB)
Collecting nvidia-cusolver-cu12==11.6.0.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cusolver_cu12-11.6.0.99-py3-none-manylinux2014_x86_64.whl (128.4 MB)
Collecting nvidia-cusparse-cu12==12.3.0.142 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cusparse_cu12-12.3.0.142-py3-none-manylinux2014_x86_64.whl (207.5 MB)
Collecting nvidia-nccl-cu12==2.20.5 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl (176.2 MB)
Collecting nvidia-nvtx-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_nvtx_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (99 kB)
Collecting nvidia-nvjitlink-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_nvjitlink_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (21.1 MB)
Collecting triton==3.0.0 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/triton-3.0.0-1-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (209.4 MB)
Requirement already satisfied: numpy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchvision==0.19.1) (1.26.4)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchvision==0.19.1) (12.0.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jinja2->torch==2.4.1) (3.0.3)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy->torch==2.4.1) (1.3.0)
Installing collected packages: triton, nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, nvidia-cusparse-cu12, nvidia-cudnn-cu12, nvidia-cusolver-cu12, torch, torchvision, torchaudio
  Attempting uninstall: triton
    Found existing installation: triton 3.6.0
    Uninstalling triton-3.6.0:
      Successfully uninstalled triton-3.6.0
  Attempting uninstall: nvidia-nvtx-cu12
    Found existing installation: nvidia-nvtx-cu12 12.8.90
    Uninstalling nvidia-nvtx-cu12-12.8.90:
      Successfully uninstalled nvidia-nvtx-cu12-12.8.90
  Attempting uninstall: nvidia-nvjitlink-cu12
    Found existing installation: nvidia-nvjitlink-cu12 12.8.93
    Uninstalling nvidia-nvjitlink-cu12-12.8.93:
      Successfully uninstalled nvidia-nvjitlink-cu12-12.8.93
  Attempting uninstall: nvidia-nccl-cu12
    Found existing installation: nvidia-nccl-cu12 2.27.5
    Uninstalling nvidia-nccl-cu12-2.27.5:
      Successfully uninstalled nvidia-nccl-cu12-2.27.5
  Attempting uninstall: nvidia-curand-cu12
    Found existing installation: nvidia-curand-cu12 10.3.9.90
    Uninstalling nvidia-curand-cu12-10.3.9.90:
      Successfully uninstalled nvidia-curand-cu12-10.3.9.90
  Attempting uninstall: nvidia-cufft-cu12
    Found existing installation: nvidia-cufft-cu12 11.3.3.83
    Uninstalling nvidia-cufft-cu12-11.3.3.83:
      Successfully uninstalled nvidia-cufft-cu12-11.3.3.83
  Attempting uninstall: nvidia-cuda-runtime-cu12
    Found existing installation: nvidia-cuda-runtime-cu12 12.8.90
    Uninstalling nvidia-cuda-runtime-cu12-12.8.90:
      Successfully uninstalled nvidia-cuda-runtime-cu12-12.8.90
  Attempting uninstall: nvidia-cuda-nvrtc-cu12
    Found existing installation: nvidia-cuda-nvrtc-cu12 12.8.93
    Uninstalling nvidia-cuda-nvrtc-cu12-12.8.93:
      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.8.93
  Attempting uninstall: nvidia-cuda-cupti-cu12
    Found existing installation: nvidia-cuda-cupti-cu12 12.8.90
    Uninstalling nvidia-cuda-cupti-cu12-12.8.90:
      Successfully uninstalled nvidia-cuda-cupti-cu12-12.8.90
  Attempting uninstall: nvidia-cublas-cu12
    Found existing installation: nvidia-cublas-cu12 12.8.4.1
    Uninstalling nvidia-cublas-cu12-12.8.4.1:
      Successfully uninstalled nvidia-cublas-cu12-12.8.4.1
  Attempting uninstall: nvidia-cusparse-cu12
    Found existing installation: nvidia-cusparse-cu12 12.5.8.93
    Uninstalling nvidia-cusparse-cu12-12.5.8.93:
      Successfully uninstalled nvidia-cusparse-cu12-12.5.8.93
  Attempting uninstall: nvidia-cudnn-cu12
    Found existing installation: nvidia-cudnn-cu12 9.10.2.21
    Uninstalling nvidia-cudnn-cu12-9.10.2.21:
      Successfully uninstalled nvidia-cudnn-cu12-9.10.2.21
  Attempting uninstall: nvidia-cusolver-cu12
    Found existing installation: nvidia-cusolver-cu12 11.7.3.90
    Uninstalling nvidia-cusolver-cu12-11.7.3.90:
      Successfully uninstalled nvidia-cusolver-cu12-11.7.3.90
Successfully installed nvidia-cublas-cu12-12.4.2.65 nvidia-cuda-cupti-cu12-12.4.99 nvidia-cuda-nvrtc-cu12-12.4.99 nvidia-cuda-runtime-cu12-12.4.99 nvidia-cudnn-cu12-9.1.0.70 nvidia-cufft-cu12-11.2.0.44 nvidia-curand-cu12-10.3.5.119 nvidia-cusolver-cu12-11.6.0.99 nvidia-cusparse-cu12-12.3.0.142 nvidia-nccl-cu12-2.20.5 nvidia-nvjitlink-cu12-12.4.99 nvidia-nvtx-cu12-12.4.99 torch-2.4.1+cu124 torchaudio-2.4.1+cu124 torchvision-0.19.1+cu124 triton-3.0.0
(difix3d_env) baodinh@asus ~/Difix3D$ pip install xformers==0.0.28.post3
Collecting xformers==0.0.28.post3
  Downloading xformers-0.0.28.post3-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (1.0 kB)
Requirement already satisfied: numpy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from xformers==0.0.28.post3) (1.26.4)
Collecting torch==2.5.1 (from xformers==0.0.28.post3)
  Downloading torch-2.5.1-cp310-cp310-manylinux1_x86_64.whl.metadata (28 kB)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.5.1->xformers==0.0.28.post3) (3.20.3)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.5.1->xformers==0.0.28.post3) (4.15.0)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.5.1->xformers==0.0.28.post3) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.5.1->xformers==0.0.28.post3) (3.1.6)
Requirement already satisfied: fsspec in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.5.1->xformers==0.0.28.post3) (2026.1.0)
Collecting nvidia-cuda-nvrtc-cu12==12.4.127 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading nvidia_cuda_nvrtc_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cuda-runtime-cu12==12.4.127 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading nvidia_cuda_runtime_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cuda-cupti-cu12==12.4.127 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading nvidia_cuda_cupti_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.5.1->xformers==0.0.28.post3) (9.1.0.70)
Collecting nvidia-cublas-cu12==12.4.5.8 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading nvidia_cublas_cu12-12.4.5.8-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cufft-cu12==11.2.1.3 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading nvidia_cufft_cu12-11.2.1.3-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-curand-cu12==10.3.5.147 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading nvidia_curand_cu12-10.3.5.147-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cusolver-cu12==11.6.1.9 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading nvidia_cusolver_cu12-11.6.1.9-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cusparse-cu12==12.3.1.170 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading nvidia_cusparse_cu12-12.3.1.170-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-nccl-cu12==2.21.5 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading nvidia_nccl_cu12-2.21.5-py3-none-manylinux2014_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-nvtx-cu12==12.4.127 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading nvidia_nvtx_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.7 kB)
Collecting nvidia-nvjitlink-cu12==12.4.127 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading nvidia_nvjitlink_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)
Collecting triton==3.1.0 (from torch==2.5.1->xformers==0.0.28.post3)
  Downloading triton-3.1.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.3 kB)
Collecting sympy==1.13.1 (from torch==2.5.1->xformers==0.0.28.post3)
  Using cached sympy-1.13.1-py3-none-any.whl.metadata (12 kB)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy==1.13.1->torch==2.5.1->xformers==0.0.28.post3) (1.3.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jinja2->torch==2.5.1->xformers==0.0.28.post3) (3.0.3)
Downloading xformers-0.0.28.post3-cp310-cp310-manylinux_2_28_x86_64.whl (16.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16.7/16.7 MB 14.4 MB/s  0:00:01
Downloading torch-2.5.1-cp310-cp310-manylinux1_x86_64.whl (906.4 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 906.4/906.4 MB 14.9 MB/s  0:00:59
Downloading nvidia_cublas_cu12-12.4.5.8-py3-none-manylinux2014_x86_64.whl (363.4 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 363.4/363.4 MB 14.3 MB/s  0:00:25
Downloading nvidia_cuda_cupti_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (13.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 13.8/13.8 MB 15.2 MB/s  0:00:00
Downloading nvidia_cuda_nvrtc_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (24.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 24.6/24.6 MB 15.1 MB/s  0:00:01
Downloading nvidia_cuda_runtime_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (883 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 883.7/883.7 kB 14.1 MB/s  0:00:00
Downloading nvidia_cufft_cu12-11.2.1.3-py3-none-manylinux2014_x86_64.whl (211.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 211.5/211.5 MB 14.9 MB/s  0:00:14
Downloading nvidia_curand_cu12-10.3.5.147-py3-none-manylinux2014_x86_64.whl (56.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 56.3/56.3 MB 13.6 MB/s  0:00:04
Downloading nvidia_cusolver_cu12-11.6.1.9-py3-none-manylinux2014_x86_64.whl (127.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 127.9/127.9 MB 14.7 MB/s  0:00:08
Downloading nvidia_cusparse_cu12-12.3.1.170-py3-none-manylinux2014_x86_64.whl (207.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 207.5/207.5 MB 14.7 MB/s  0:00:14
Downloading nvidia_nccl_cu12-2.21.5-py3-none-manylinux2014_x86_64.whl (188.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 188.7/188.7 MB 14.2 MB/s  0:00:13
Downloading nvidia_nvjitlink_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (21.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 21.1/21.1 MB 12.5 MB/s  0:00:01
Downloading nvidia_nvtx_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (99 kB)
Using cached sympy-1.13.1-py3-none-any.whl (6.2 MB)
Downloading triton-3.1.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (209.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 209.5/209.5 MB 14.7 MB/s  0:00:14
Installing collected packages: triton, sympy, nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, nvidia-cusparse-cu12, nvidia-cusolver-cu12, torch, xformers
  Attempting uninstall: triton
    Found existing installation: triton 3.0.0
    Uninstalling triton-3.0.0:
      Successfully uninstalled triton-3.0.0
  Attempting uninstall: sympy
    Found existing installation: sympy 1.14.0
    Uninstalling sympy-1.14.0:
      Successfully uninstalled sympy-1.14.0
  Attempting uninstall: nvidia-nvtx-cu12
    Found existing installation: nvidia-nvtx-cu12 12.4.99
    Uninstalling nvidia-nvtx-cu12-12.4.99:
      Successfully uninstalled nvidia-nvtx-cu12-12.4.99
  Attempting uninstall: nvidia-nvjitlink-cu12
    Found existing installation: nvidia-nvjitlink-cu12 12.4.99
    Uninstalling nvidia-nvjitlink-cu12-12.4.99:
      Successfully uninstalled nvidia-nvjitlink-cu12-12.4.99
  Attempting uninstall: nvidia-nccl-cu12
    Found existing installation: nvidia-nccl-cu12 2.20.5
    Uninstalling nvidia-nccl-cu12-2.20.5:
      Successfully uninstalled nvidia-nccl-cu12-2.20.5
  Attempting uninstall: nvidia-curand-cu12
    Found existing installation: nvidia-curand-cu12 10.3.5.119
    Uninstalling nvidia-curand-cu12-10.3.5.119:
      Successfully uninstalled nvidia-curand-cu12-10.3.5.119
  Attempting uninstall: nvidia-cufft-cu12
    Found existing installation: nvidia-cufft-cu12 11.2.0.44
    Uninstalling nvidia-cufft-cu12-11.2.0.44:
      Successfully uninstalled nvidia-cufft-cu12-11.2.0.44
  Attempting uninstall: nvidia-cuda-runtime-cu12
    Found existing installation: nvidia-cuda-runtime-cu12 12.4.99
    Uninstalling nvidia-cuda-runtime-cu12-12.4.99:
      Successfully uninstalled nvidia-cuda-runtime-cu12-12.4.99
  Attempting uninstall: nvidia-cuda-nvrtc-cu12
    Found existing installation: nvidia-cuda-nvrtc-cu12 12.4.99
    Uninstalling nvidia-cuda-nvrtc-cu12-12.4.99:
      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.4.99
  Attempting uninstall: nvidia-cuda-cupti-cu12
    Found existing installation: nvidia-cuda-cupti-cu12 12.4.99
    Uninstalling nvidia-cuda-cupti-cu12-12.4.99:
      Successfully uninstalled nvidia-cuda-cupti-cu12-12.4.99
  Attempting uninstall: nvidia-cublas-cu12
    Found existing installation: nvidia-cublas-cu12 12.4.2.65
    Uninstalling nvidia-cublas-cu12-12.4.2.65:
      Successfully uninstalled nvidia-cublas-cu12-12.4.2.65
  Attempting uninstall: nvidia-cusparse-cu12
    Found existing installation: nvidia-cusparse-cu12 12.3.0.142
    Uninstalling nvidia-cusparse-cu12-12.3.0.142:
      Successfully uninstalled nvidia-cusparse-cu12-12.3.0.142
  Attempting uninstall: nvidia-cusolver-cu12
    Found existing installation: nvidia-cusolver-cu12 11.6.0.99
    Uninstalling nvidia-cusolver-cu12-11.6.0.99:
      Successfully uninstalled nvidia-cusolver-cu12-11.6.0.99
  Attempting uninstall: torch
    Found existing installation: torch 2.4.1+cu124
    Uninstalling torch-2.4.1+cu124:
      Successfully uninstalled torch-2.4.1+cu124
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
torchaudio 2.4.1+cu124 requires torch==2.4.1, but you have torch 2.5.1 which is incompatible.
torchvision 0.19.1+cu124 requires torch==2.4.1, but you have torch 2.5.1 which is incompatible.
Successfully installed nvidia-cublas-cu12-12.4.5.8 nvidia-cuda-cupti-cu12-12.4.127 nvidia-cuda-nvrtc-cu12-12.4.127 nvidia-cuda-runtime-cu12-12.4.127 nvidia-cufft-cu12-11.2.1.3 nvidia-curand-cu12-10.3.5.147 nvidia-cusolver-cu12-11.6.1.9 nvidia-cusparse-cu12-12.3.1.170 nvidia-nccl-cu12-2.21.5 nvidia-nvjitlink-cu12-12.4.127 nvidia-nvtx-cu12-12.4.127 sympy-1.13.1 torch-2.5.1 triton-3.1.0 xformers-0.0.28.post3
(difix3d_env) baodinh@asus ~/Difix3D$ pip install torch==2.4.1 torchvision==0.19.1 torchaudio==2.4.1 --index-url https://download.pytorch.org/whl/cu124
Looking in indexes: https://download.pytorch.org/whl/cu124
Collecting torch==2.4.1
  Using cached https://download.pytorch.org/whl/cu124/torch-2.4.1%2Bcu124-cp310-cp310-linux_x86_64.whl (797.2 MB)
Requirement already satisfied: torchvision==0.19.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (0.19.1+cu124)
Requirement already satisfied: torchaudio==2.4.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (2.4.1+cu124)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.20.3)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (4.15.0)
Requirement already satisfied: sympy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (1.13.1)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.1.6)
Requirement already satisfied: fsspec in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (2026.1.0)
Collecting nvidia-cuda-nvrtc-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cuda_nvrtc_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (24.7 MB)
Collecting nvidia-cuda-runtime-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cuda_runtime_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (883 kB)
Collecting nvidia-cuda-cupti-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cuda_cupti_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (13.8 MB)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (9.1.0.70)
Collecting nvidia-cublas-cu12==12.4.2.65 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cublas_cu12-12.4.2.65-py3-none-manylinux2014_x86_64.whl (363.0 MB)
Collecting nvidia-cufft-cu12==11.2.0.44 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cufft_cu12-11.2.0.44-py3-none-manylinux2014_x86_64.whl (211.5 MB)
Collecting nvidia-curand-cu12==10.3.5.119 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_curand_cu12-10.3.5.119-py3-none-manylinux2014_x86_64.whl (56.3 MB)
Collecting nvidia-cusolver-cu12==11.6.0.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cusolver_cu12-11.6.0.99-py3-none-manylinux2014_x86_64.whl (128.4 MB)
Collecting nvidia-cusparse-cu12==12.3.0.142 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_cusparse_cu12-12.3.0.142-py3-none-manylinux2014_x86_64.whl (207.5 MB)
Collecting nvidia-nccl-cu12==2.20.5 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl (176.2 MB)
Collecting nvidia-nvtx-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_nvtx_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (99 kB)
Collecting nvidia-nvjitlink-cu12==12.4.99 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/cu124/nvidia_nvjitlink_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (21.1 MB)
Collecting triton==3.0.0 (from torch==2.4.1)
  Using cached https://download.pytorch.org/whl/triton-3.0.0-1-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (209.4 MB)
Requirement already satisfied: numpy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchvision==0.19.1) (1.26.4)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchvision==0.19.1) (12.0.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jinja2->torch==2.4.1) (3.0.3)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy->torch==2.4.1) (1.3.0)
Installing collected packages: triton, nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, nvidia-cusparse-cu12, nvidia-cusolver-cu12, torch
  Attempting uninstall: triton
    Found existing installation: triton 3.1.0
    Uninstalling triton-3.1.0:
      Successfully uninstalled triton-3.1.0
  Attempting uninstall: nvidia-nvtx-cu12
    Found existing installation: nvidia-nvtx-cu12 12.4.127
    Uninstalling nvidia-nvtx-cu12-12.4.127:
      Successfully uninstalled nvidia-nvtx-cu12-12.4.127
  Attempting uninstall: nvidia-nvjitlink-cu12
    Found existing installation: nvidia-nvjitlink-cu12 12.4.127
    Uninstalling nvidia-nvjitlink-cu12-12.4.127:
      Successfully uninstalled nvidia-nvjitlink-cu12-12.4.127
  Attempting uninstall: nvidia-nccl-cu12
    Found existing installation: nvidia-nccl-cu12 2.21.5
    Uninstalling nvidia-nccl-cu12-2.21.5:
      Successfully uninstalled nvidia-nccl-cu12-2.21.5
  Attempting uninstall: nvidia-curand-cu12
    Found existing installation: nvidia-curand-cu12 10.3.5.147
    Uninstalling nvidia-curand-cu12-10.3.5.147:
      Successfully uninstalled nvidia-curand-cu12-10.3.5.147
  Attempting uninstall: nvidia-cufft-cu12
    Found existing installation: nvidia-cufft-cu12 11.2.1.3
    Uninstalling nvidia-cufft-cu12-11.2.1.3:
      Successfully uninstalled nvidia-cufft-cu12-11.2.1.3
  Attempting uninstall: nvidia-cuda-runtime-cu12
    Found existing installation: nvidia-cuda-runtime-cu12 12.4.127
    Uninstalling nvidia-cuda-runtime-cu12-12.4.127:
      Successfully uninstalled nvidia-cuda-runtime-cu12-12.4.127
  Attempting uninstall: nvidia-cuda-nvrtc-cu12
    Found existing installation: nvidia-cuda-nvrtc-cu12 12.4.127
    Uninstalling nvidia-cuda-nvrtc-cu12-12.4.127:
      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.4.127
  Attempting uninstall: nvidia-cuda-cupti-cu12
    Found existing installation: nvidia-cuda-cupti-cu12 12.4.127
    Uninstalling nvidia-cuda-cupti-cu12-12.4.127:
      Successfully uninstalled nvidia-cuda-cupti-cu12-12.4.127
  Attempting uninstall: nvidia-cublas-cu12
    Found existing installation: nvidia-cublas-cu12 12.4.5.8
    Uninstalling nvidia-cublas-cu12-12.4.5.8:
      Successfully uninstalled nvidia-cublas-cu12-12.4.5.8
  Attempting uninstall: nvidia-cusparse-cu12
    Found existing installation: nvidia-cusparse-cu12 12.3.1.170
    Uninstalling nvidia-cusparse-cu12-12.3.1.170:
      Successfully uninstalled nvidia-cusparse-cu12-12.3.1.170
  Attempting uninstall: nvidia-cusolver-cu12
    Found existing installation: nvidia-cusolver-cu12 11.6.1.9
    Uninstalling nvidia-cusolver-cu12-11.6.1.9:
      Successfully uninstalled nvidia-cusolver-cu12-11.6.1.9
  Attempting uninstall: torch
    Found existing installation: torch 2.5.1
    Uninstalling torch-2.5.1:
      Successfully uninstalled torch-2.5.1
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
xformers 0.0.28.post3 requires torch==2.5.1, but you have torch 2.4.1+cu124 which is incompatible.
Successfully installed nvidia-cublas-cu12-12.4.2.65 nvidia-cuda-cupti-cu12-12.4.99 nvidia-cuda-nvrtc-cu12-12.4.99 nvidia-cuda-runtime-cu12-12.4.99 nvidia-cufft-cu12-11.2.0.44 nvidia-curand-cu12-10.3.5.119 nvidia-cusolver-cu12-11.6.0.99 nvidia-cusparse-cu12-12.3.0.142 nvidia-nccl-cu12-2.20.5 nvidia-nvjitlink-cu12-12.4.99 nvidia-nvtx-cu12-12.4.99 torch-2.4.1+cu124 triton-3.0.0
(difix3d_env) baodinh@asus ~/Difix3D$ pip uninstall torch torchvision torchaudio xformers fused-ssim -y
Found existing installation: torch 2.4.1+cu124
Uninstalling torch-2.4.1+cu124:
  Successfully uninstalled torch-2.4.1+cu124
Found existing installation: torchvision 0.19.1+cu124
Uninstalling torchvision-0.19.1+cu124:
  Successfully uninstalled torchvision-0.19.1+cu124
Found existing installation: torchaudio 2.4.1+cu124
Uninstalling torchaudio-2.4.1+cu124:
  Successfully uninstalled torchaudio-2.4.1+cu124
Found existing installation: xformers 0.0.28.post3
Uninstalling xformers-0.0.28.post3:
  Successfully uninstalled xformers-0.0.28.post3
Found existing installation: fused-ssim 1.0.0
Uninstalling fused-ssim-1.0.0:
  Successfully uninstalled fused-ssim-1.0.0
(difix3d_env) baodinh@asus ~/Difix3D$ pip install torch==2.4.1 torchvision==0.19.1 torchaudio==2.4.1 --index-url https://download.pytorch.org/whl/cu124
Looking in indexes: https://download.pytorch.org/whl/cu124
Collecting torch==2.4.1
  Using cached https://download.pytorch.org/whl/cu124/torch-2.4.1%2Bcu124-cp310-cp310-linux_x86_64.whl (797.2 MB)
Collecting torchvision==0.19.1
  Using cached https://download.pytorch.org/whl/cu124/torchvision-0.19.1%2Bcu124-cp310-cp310-linux_x86_64.whl (7.1 MB)
Collecting torchaudio==2.4.1
  Using cached https://download.pytorch.org/whl/cu124/torchaudio-2.4.1%2Bcu124-cp310-cp310-linux_x86_64.whl (3.4 MB)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.20.3)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (4.15.0)
Requirement already satisfied: sympy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (1.13.1)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.1.6)
Requirement already satisfied: fsspec in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (2026.1.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (12.4.99)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (12.4.99)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (12.4.99)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.4.2.65 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (12.4.2.65)
Requirement already satisfied: nvidia-cufft-cu12==11.2.0.44 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (11.2.0.44)
Requirement already satisfied: nvidia-curand-cu12==10.3.5.119 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (10.3.5.119)
Requirement already satisfied: nvidia-cusolver-cu12==11.6.0.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (11.6.0.99)
Requirement already satisfied: nvidia-cusparse-cu12==12.3.0.142 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (12.3.0.142)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (2.20.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (12.4.99)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (12.4.99)
Requirement already satisfied: triton==3.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch==2.4.1) (3.0.0)
Requirement already satisfied: numpy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchvision==0.19.1) (1.26.4)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torchvision==0.19.1) (12.0.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jinja2->torch==2.4.1) (3.0.3)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy->torch==2.4.1) (1.3.0)
Installing collected packages: torch, torchvision, torchaudio
Successfully installed torch-2.4.1+cu124 torchaudio-2.4.1+cu124 torchvision-0.19.1+cu124
(difix3d_env) baodinh@asus ~/Difix3D$ # 1. Cài fused-ssim (Bắt buộc cho gsplat) - Dùng cờ bảo vệ để không đụng vào Torch
pip install git+https://github.com/rahul-goel/fused-ssim --force-reinstall --no-deps --no-build-isolation

# 2. Cài lại gsplat cho chắc ăn
pip install gsplat==1.5.3
Collecting git+https://github.com/rahul-goel/fused-ssim
  Cloning https://github.com/rahul-goel/fused-ssim to /tmp/pip-req-build-s94ugdwe
  Running command git clone --filter=blob:none --quiet https://github.com/rahul-goel/fused-ssim /tmp/pip-req-build-s94ugdwe
  Resolved https://github.com/rahul-goel/fused-ssim to commit 0ac916a05f48f8e477dc8ce1651a346b65ce2072
  Preparing metadata (pyproject.toml) ... done
Building wheels for collected packages: fused-ssim
  Building wheel for fused-ssim (pyproject.toml) ... done
  Created wheel for fused-ssim: filename=fused_ssim-1.0.0-cp310-cp310-linux_x86_64.whl size=142077 sha256=87b28f1b981d08d2cc95555a56772bb7c1f3c07f13f6676e2813d1c7e14eba95
  Stored in directory: /tmp/pip-ephem-wheel-cache-t9dep842/wheels/ab/6e/5f/1691340c88bd2bb55b7c5905183d398dbc079b5e4e01adf9ee
Successfully built fused-ssim
Installing collected packages: fused-ssim
Successfully installed fused-ssim-1.0.0
Requirement already satisfied: gsplat==1.5.3 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (1.5.3)
Requirement already satisfied: ninja in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat==1.5.3) (1.13.0)
Requirement already satisfied: numpy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat==1.5.3) (1.26.4)
Requirement already satisfied: jaxtyping in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat==1.5.3) (0.3.6)
Requirement already satisfied: rich>=12 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat==1.5.3) (14.3.1)
Requirement already satisfied: torch in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from gsplat==1.5.3) (2.4.1+cu124)
Requirement already satisfied: markdown-it-py>=2.2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from rich>=12->gsplat==1.5.3) (4.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from rich>=12->gsplat==1.5.3) (2.19.2)
Requirement already satisfied: mdurl~=0.1 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from markdown-it-py>=2.2.0->rich>=12->gsplat==1.5.3) (0.1.2)
Requirement already satisfied: wadler-lindig>=0.1.3 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jaxtyping->gsplat==1.5.3) (0.1.7)
Requirement already satisfied: filelock in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (3.20.3)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (4.15.0)
Requirement already satisfied: sympy in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (1.13.1)
Requirement already satisfied: networkx in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (3.4.2)
Requirement already satisfied: jinja2 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (3.1.6)
Requirement already satisfied: fsspec in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (2026.1.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.99)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.99)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.99)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.4.2.65 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.2.65)
Requirement already satisfied: nvidia-cufft-cu12==11.2.0.44 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (11.2.0.44)
Requirement already satisfied: nvidia-curand-cu12==10.3.5.119 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (10.3.5.119)
Requirement already satisfied: nvidia-cusolver-cu12==11.6.0.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (11.6.0.99)
Requirement already satisfied: nvidia-cusparse-cu12==12.3.0.142 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.3.0.142)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (2.20.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.99)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.4.99 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (12.4.99)
Requirement already satisfied: triton==3.0.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from torch->gsplat==1.5.3) (3.0.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from jinja2->torch->gsplat==1.5.3) (3.0.3)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages (from sympy->torch->gsplat==1.5.3) (1.3.0)
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default \
    --data_dir data/garden \
    --data_factor 4 \
    --result_dir outputs/difix3d_result \
    --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt \
    --iterations 32000 \
    --save_every 500 \
    --test_every 1000 \
    --disable_viewer
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
╭─ Unrecognized options ──────────────────────────────────────────────────╮
│ Unrecognized options: --iterations, 32000, --save_every, 500            │
│ ─────────────────────────────────────────────────────────────────────── │
│ For full helptext, run examples/gsplat/simple_trainer_difix3d.py --help │
╰─────────────────────────────────────────────────────────────────────────╯
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py --help
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
usage: examples/gsplat/simple_trainer_difix3d.py [-h] {default,mcmc}

╭─ options ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ -h, --help   show this help message and exit                                                                                     │
╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─ subcommands ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ (required)                                                                                                                       │
│   • default  Gaussian splatting training using densification heuristics from the original paper.                                 │
│   • mcmc     Gaussian splatting training using densification from the paper '3D Gaussian Splatting as Markov Chain Monte Carlo'. │
╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
(difix3d_env) baodinh@asus ~/Difix3D$ # Đảm bảo PYTHONPATH trỏ đúng
export PYTHONPATH=$PYTHONPATH:$(pwd)/src

# Chạy lệnh đã sửa (Copy nguyên khối này)
python examples/gsplat/simple_trainer_difix3d.py default \
    --data_dir data/garden \
    --data_factor 4 \
    --result_dir outputs/difix3d_result \
    --ckpt outputs/garden_base/ckpts/ckpt_29999_rank0.pt \
    --max_steps 32000 \
    --save_steps 30500 31000 31500 32000 \
    --eval_steps 31000 32000 \
    --fix_steps 30000 32000 \
    --disable_viewer
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
Warning: image_path not found for reconstruction
[Parser] 185 images, taken by 1 cameras.
Scene scale: 1.2265263065808911
Model initialized. Number of GS: 138766
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:332: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
model_index.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 598/598 [00:00<00:00, 1.34MB/s]
special_tokens_map.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 574/574 [00:00<00:00, 2.25MB/s]
config.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 607/607 [00:00<00:00, 2.53MB/s]
config.json: 1.86kB [00:00, 4.91MB/s]                                                                                               | 0.00/607 [00:00<?, ?B/s]
scheduler_config.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 700/700 [00:00<00:00, 3.41MB/s]
tokenizer_config.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 885/885 [00:00<00:00, 3.51MB/s]
vocab.json: 1.06MB [00:00, 8.70MB/s]██▋                                                                                        | 2/14 [00:00<00:02,  4.06it/s]
merges.txt: 525kB [00:00, 4.64MB/s]
config.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 702/702 [00:00<00:00, 3.96MB/s]
autoencoder_kl.py: 24.5kB [00:00, 35.7MB/s]                                                                                         | 0.00/702 [00:00<?, ?B/s]
unet_2d_condition.py: 69.2kB [00:00, 53.8MB/s]
diffusion_pytorch_model.safetensors: 100%|█████████████████████████████████████████████████████████████████████████████████| 339M/339M [01:17<00:00, 4.39MB/s]
model.safetensors: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 1.36G/1.36G [03:32<00:00, 6.40MB/s]
diffusion_pytorch_model.safetensors: 100%|███████████████████████████████████████████████████████████████████████████████| 3.46G/3.46G [05:44<00:00, 10.0MB/s]
Fetching 14 files: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [05:46<00:00, 24.73s/it]
Keyword arguments {'trust_remote_code': True} are not expected by DifixPipeline and will be ignored.█████████████████████| 1.36G/1.36G [03:32<00:00, 7.51MB/s]
Loading pipeline components...:   0%|                                                                                                   | 0/5 [00:00<?, ?it/s]/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 14.04it/s]
You have disabled the safety checker for <class 'src.pipeline_difix.DifixPipeline'> by passing `safety_checker=None`. Ensure that you abide to the conditions of the Stable Diffusion license and do not expose unfiltered results in services or applications open to the public. Both the diffusers team and Hugging Face strongly recommend to keep the safety filter enabled in all public facing circumstances, disabling it only for use-cases that involve analyzing network behavior or auditing its results. For more information, please have a look at https://github.com/huggingface/diffusers/pull/254 .
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 1193, in <module>
    cli(main, cfg, verbose=True)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/distributed.py", line 360, in cli
    return _distributed_worker(0, 1, fn=fn, args=args)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/distributed.py", line 295, in _distributed_worker
    fn(local_rank, world_rank, world_size, args)
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 1129, in main
    ckpts = [
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 1130, in <listcomp>
    torch.load(file, map_location=runner.device, weights_only=True)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/serialization.py", line 1072, in load
    with _open_zipfile_reader(opened_file) as opened_zipfile:
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/serialization.py", line 480, in __init__
    super().__init__(torch._C.PyTorchFileReader(name_or_buffer))
RuntimeError: PytorchStreamReader failed reading zip archive: failed finding central directory
(difix3d_env) baodinh@asus ~/Difix3D$ # 1. Export path (cho chắc ăn)
export PYTHONPATH=$PYTHONPATH:$(pwd)/src

# 2. Chạy lệnh
python examples/gsplat/simple_trainer_difix3d.py default \
    --data_dir data/garden \
    --data_factor 4 \
    --result_dir outputs/difix3d_result \
    --ckpt outputs/garden_base/ckpts/ckpt_6999_rank0.pt \
    --max_steps 32000 \
    --save_steps 30500 31000 31500 32000 \
    --eval_steps 31000 32000 \
    --fix_steps 30000 32000 \
    --disable_viewer
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
Warning: image_path not found for reconstruction
[Parser] 185 images, taken by 1 cameras.
Scene scale: 1.2265263065808911
Model initialized. Number of GS: 138766
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:332: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Keyword arguments {'trust_remote_code': True} are not expected by DifixPipeline and will be ignored.
Loading pipeline components...:   0%|                                                                                                   | 0/5 [00:00<?, ?it/s]/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 13.71it/s]
You have disabled the safety checker for <class 'src.pipeline_difix.DifixPipeline'> by passing `safety_checker=None`. Ensure that you abide to the conditions of the Stable Diffusion license and do not expose unfiltered results in services or applications open to the public. Both the diffusers team and Hugging Face strongly recommend to keep the safety filter enabled in all public facing circumstances, disabling it only for use-cases that involve analyzing network behavior or auditing its results. For more information, please have a look at https://github.com/huggingface/diffusers/pull/254 .
  0%|                                                                                                                               | 0/25001 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 1193, in <module>
    cli(main, cfg, verbose=True)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/distributed.py", line 360, in cli
    return _distributed_worker(0, 1, fn=fn, args=args)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/distributed.py", line 295, in _distributed_worker
    fn(local_rank, world_rank, world_size, args)
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 1136, in main
    runner.train(step=step)
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 625, in train
    renders, alphas, info = self.rasterize_splats(
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 501, in rasterize_splats
    viewmats=torch.linalg.inv(camtoworlds),  # [C, 4, 4]
RuntimeError: cusolver error: CUSOLVER_STATUS_INTERNAL_ERROR, when calling `cusolverDnCreate(handle)`. If you keep seeing this error, you may use `torch.backends.cuda.preferred_linalg_library()` to try linear algebra operators with other supported backends. See https://pytorch.org/docs/stable/backends.html#torch.backends.cuda.preferred_linalg_library
(difix3d_env) baodinh@asus ~/Difix3D$ export PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default \
    --data_dir data/garden \
    --data_factor 4 \
    --result_dir outputs/difix3d_result \
    --ckpt outputs/garden_base/ckpts/ckpt_6999_rank0.pt \
    --max_steps 32000 \
    --save_steps 30500 31000 31500 32000 \
    --eval_steps 31000 32000 \
    --fix_steps 30000 32000 \
    --disable_viewer
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
Warning: image_path not found for reconstruction
[Parser] 185 images, taken by 1 cameras.
Scene scale: 1.2265263065808911
Model initialized. Number of GS: 138766
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:332: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Keyword arguments {'trust_remote_code': True} are not expected by DifixPipeline and will be ignored.
Loading pipeline components...:  60%|██████████████████████████████████████████████████████▌                                    | 3/5 [00:00<00:00, 10.63it/s]/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 13.38it/s]
You have disabled the safety checker for <class 'src.pipeline_difix.DifixPipeline'> by passing `safety_checker=None`. Ensure that you abide to the conditions of the Stable Diffusion license and do not expose unfiltered results in services or applications open to the public. Both the diffusers team and Hugging Face strongly recommend to keep the safety filter enabled in all public facing circumstances, disabling it only for use-cases that involve analyzing network behavior or auditing its results. For more information, please have a look at https://github.com/huggingface/diffusers/pull/254 .
  0%|                                                                                                                               | 0/25001 [00:00<?, ?it/s]/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/utils/cpp_extension.py:1965: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all 
archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
gsplat: CUDA extension has been set up successfully in 57.27 seconds.
  0%|                                                                                                                               | 0/25001 [00:57<?, ?it/s]
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 1193, in <module>
    cli(main, cfg, verbose=True)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/distributed.py", line 360, in cli
    return _distributed_worker(0, 1, fn=fn, args=args)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/distributed.py", line 295, in _distributed_worker
    fn(local_rank, world_rank, world_size, args)
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 1136, in main
    runner.train(step=step)
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 625, in train
    renders, alphas, info = self.rasterize_splats(
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 495, in rasterize_splats
    render_colors, render_alphas, info = rasterization(
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/rendering.py", line 409, in rasterization
    proj_results = fully_fused_projection(
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/cuda/_wrapper.py", line 423, in fully_fused_projection
    return _FullyFusedProjection.apply(
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/autograd/function.py", line 574, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/cuda/_wrapper.py", line 1061, in forward
    radii, means2d, depths, conics, compensations = _make_lazy_cuda_func(
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/cuda/_wrapper.py", line 17, in call_cuda
    return getattr(_C, name)(*args, **kwargs)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 16.00 MiB. GPU 0 has a total capacity of 7.62 GiB of which 13.19 MiB is free. Including non-PyTorch memory, this process has 7.59 GiB memory in use. Of the allocated memory 7.42 GiB is allocated by PyTorch, and 21.61 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)


(difix3d_env) baodinh@asus ~/Difix3D$ python examples/gsplat/simple_trainer_difix3d.py default \
    --data_dir data/garden \
    --data_factor 8 \
    --result_dir outputs/difix3d_result \
    --ckpt outputs/garden_base/ckpts/ckpt_6999_rank0.pt \
    --max_steps 32000 \
    --save_steps 30500 31000 31500 32000 \
    --eval_steps 31000 32000 \
    --fix_steps 30000 32000 \
    --disable_viewer
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
Warning: image_path not found for reconstruction
[Parser] 185 images, taken by 1 cameras.
Scene scale: 1.2265263065808911
Model initialized. Number of GS: 138766
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torchmetrics/functional/image/lpips.py:332: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location="cpu"), strict=False)
/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:1142: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Keyword arguments {'trust_remote_code': True} are not expected by DifixPipeline and will be ignored.
Loading pipeline components...:  40%|████████████████████████████████████▍                                                      | 2/5 [00:00<00:00,  7.74it/s]/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.25it/s]
You have disabled the safety checker for <class 'src.pipeline_difix.DifixPipeline'> by passing `safety_checker=None`. Ensure that you abide to the conditions of the Stable Diffusion license and do not expose unfiltered results in services or applications open to the public. Both the diffusers team and Hugging Face strongly recommend to keep the safety filter enabled in all public facing circumstances, disabling it only for use-cases that involve analyzing network behavior or auditing its results. For more information, please have a look at https://github.com/huggingface/diffusers/pull/254 .
  0%|                                                                                                                               | 0/25001 [00:00<?, ?it/s]/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/utils/cpp_extension.py:1965: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
loss=0.108| sh degree=3| :   0%|                                                                                          | 1/25001 [00:00<5:13:15,  1.33it/s]Step 7000: 87518 GSs duplicated, 7173 GSs split. Now having 4080595 GSs.
Step 7000: 2464 GSs pruned. Now having 4078131 GSs.
loss=0.069| sh degree=3| :   0%|▎                                                                                       | 101/25001 [00:18<1:10:19,  5.90it/s]Step 7100: 123124 GSs duplicated, 14494 GSs split. Now having 4215749 GSs.
Step 7100: 7334 GSs pruned. Now having 4208415 GSs.
loss=0.059| sh degree=3| :   1%|▋                                                                                       | 201/25001 [00:35<1:13:37,  5.61it/s]
Traceback (most recent call last):
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 1194, in <module>
    cli(main, cfg, verbose=True)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/distributed.py", line 360, in cli
    return _distributed_worker(0, 1, fn=fn, args=args)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/distributed.py", line 295, in _distributed_worker
    fn(local_rank, world_rank, world_size, args)
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 1137, in main
    runner.train(step=step)
  File "/home/baodinh/Difix3D/examples/gsplat/simple_trainer_difix3d.py", line 817, in train
    self.cfg.strategy.step_post_backward(
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/strategy/default.py", line 173, in step_post_backward
    n_dupli, n_split = self._grow_gs(params, optimizers, state, step)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/strategy/default.py", line 302, in _grow_gs
    split(
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/strategy/ops.py", line 174, in split
    _update_param_with_optimizer(param_fn, optimizer_fn, params, optimizers)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/strategy/ops.py", line 87, in _update_param_with_optimizer
    param_state[key] = optimizer_fn(key, v)
  File "/home/baodinh/miniconda3/envs/difix3d_env/lib/python3.10/site-packages/gsplat/strategy/ops.py", line 171, in optimizer_fn
    return torch.cat([v[rest], v_split])
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 740.00 MiB. GPU 0 has a total capacity of 7.62 GiB of which 713.19 MiB is free. Including non-PyTorch memory, this process has 6.90 GiB memory in use. Of the allocated memory 6.44 GiB is allocated by PyTorch, and 331.04 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)